// Copyright 2017 The go-ethereum Authors
// This file is part of the go-ethereum library.
//
// The go-ethereum library is free software: you can redistribute it and/or modify
// it under the terms of the GNU Lesser General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
//
// The go-ethereum library is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
// GNU Lesser General Public License for more details.
//
// You should have received a copy of the GNU Lesser General Public License
// along with the go-ethereum library. If not, see <http://www.gnu.org/licenses/>.

package ethash

import (
	"encoding/binary"
	"hash"
	"reflect"
	"runtime"
	"sync"
	"sync/atomic"
	"time"
	"unsafe"

	"github.com/ethereum/go-ethereum/common"
	"github.com/ethereum/go-ethereum/common/bitutil"
	"github.com/ethereum/go-ethereum/crypto"
	"github.com/ethereum/go-ethereum/crypto/sha3"
	"github.com/ethereum/go-ethereum/log"
)

const (
	datasetInitBytes   = 1 << 24 // Bytes in dataset at genesis (~168 MB)
	datasetGrowthBytes = 1 << 13 // Dataset growth per epoch (~0.008192 MB)
	cacheInitBytes     = 1 << 24 // Bytes in cache at genesis
	cacheGrowthBytes   = 1 << 17 // Cache growth per epoch
	epochLength        = 30000   // Blocks per epoch
	mixBytes           = 128     // Width of mix
	hashBytes          = 64      // Hash length in bytes
	hashWords          = 16      // Number of 32 bit ints in a hash
	datasetParents     = 256     // Number of parents of each dataset element
	cacheRounds        = 3       // Number of rounds in cache production
	loopAccesses       = 64      // Number of accesses in hashimoto loop
)

// hasher is a repetitive hasher allowing the same hash data structures to be
// reused between hash runs instead of requiring new ones to be created.
type hasher func(dest []byte, data []byte)

// makeHasher creates a repetitive hasher, allowing the same hash data structures
// to be reused between hash runs instead of requiring new ones to be created.
// The returned function is not thread safe!
func makeHasher(h hash.Hash) hasher {
	return func(dest []byte, data []byte) {
		h.Write(data)
		h.Sum(dest[:0])
		h.Reset()
	}
}

// seedHash is the seed to use for generating a verification cache and the mining
// dataset.
func seedHash(block uint64) []byte {
	seed := make([]byte, 32)
	if block < epochLength {
		return seed
	}
	keccak256 := makeHasher(sha3.NewKeccak256())
	for i := 0; i < int(block/epochLength); i++ {
		keccak256(seed, seed)
	}
	return seed
}

// generateCache creates a verification cache of a given size for an input seed.
// The cache production process involves first sequentially filling up 32 MB of
// memory, then performing two passes of Sergio Demian Lerner's RandMemoHash
// algorithm from Strict Memory Hard Hashing Functions (2014). The output is a
// set of 524288 64-byte values.
// This method places the result into dest in machine byte order.
func generateCache(dest []uint32, epoch uint64, seed []byte) {
	// Print some debug logs to allow analysis on low end devices
	logger := log.New("epoch", epoch)

	start := time.Now()
	defer func() {
		elapsed := time.Since(start)

		logFn := logger.Debug
		if elapsed > 3*time.Second {
			logFn = logger.Info
		}
		logFn("Generated ethash verification cache", "elapsed", common.PrettyDuration(elapsed))
	}()
	// Convert our destination slice to a byte buffer
	header := *(*reflect.SliceHeader)(unsafe.Pointer(&dest))
	header.Len *= 4
	header.Cap *= 4
	cache := *(*[]byte)(unsafe.Pointer(&header))

	// Calculate the number of theoretical rows (we'll store in one buffer nonetheless)
	size := uint64(len(cache))
	rows := int(size) / hashBytes

	// Start a monitoring goroutine to report progress on low end devices
	var progress uint32

	done := make(chan struct{})
	defer close(done)

	go func() {
		for {
			select {
			case <-done:
				return
			case <-time.After(3 * time.Second):
				logger.Info("Generating ethash verification cache", "percentage", atomic.LoadUint32(&progress)*100/uint32(rows)/4, "elapsed", common.PrettyDuration(time.Since(start)))
			}
		}
	}()
	// Create a hasher to reuse between invocations
	keccak512 := makeHasher(sha3.NewKeccak512())

	// Sequentially produce the initial dataset
	keccak512(cache, seed)
	for offset := uint64(hashBytes); offset < size; offset += hashBytes {
		keccak512(cache[offset:], cache[offset-hashBytes:offset])
		atomic.AddUint32(&progress, 1)
	}
	// Use a low-round version of randmemohash
	temp := make([]byte, hashBytes)

	for i := 0; i < cacheRounds; i++ {
		for j := 0; j < rows; j++ {
			var (
				srcOff = ((j - 1 + rows) % rows) * hashBytes
				dstOff = j * hashBytes
				xorOff = (binary.LittleEndian.Uint32(cache[dstOff:]) % uint32(rows)) * hashBytes
			)
			bitutil.XORBytes(temp, cache[srcOff:srcOff+hashBytes], cache[xorOff:xorOff+hashBytes])
			keccak512(cache[dstOff:], temp)

			atomic.AddUint32(&progress, 1)
		}
	}
	// Swap the byte order on big endian systems and return
	if !isLittleEndian() {
		swap(cache)
	}
}

// swap changes the byte order of the buffer assuming a uint32 representation.
func swap(buffer []byte) {
	for i := 0; i < len(buffer); i += 4 {
		binary.BigEndian.PutUint32(buffer[i:], binary.LittleEndian.Uint32(buffer[i:]))
	}
}

// prepare converts an ethash cache or dataset from a byte stream into the internal
// int representation. All ethash methods work with ints to avoid constant byte to
// int conversions as well as to handle both little and big endian systems.
func prepare(dest []uint32, src []byte) {
	for i := 0; i < len(dest); i++ {
		dest[i] = binary.LittleEndian.Uint32(src[i*4:])
	}
}

// fnv is an algorithm inspired by the FNV hash, which in some cases is used as
// a non-associative substitute for XOR. Note that we multiply the prime with
// the full 32-bit input, in contrast with the FNV-1 spec which multiplies the
// prime with one byte (octet) in turn.
func fnv(a, b uint32) uint32 {
	return a*0x01000193 ^ b
}

// fnvHash mixes in data into mix using the ethash fnv method.
func fnvHash(mix []uint32, data []uint32) {
	for i := 0; i < len(mix); i++ {
		mix[i] = mix[i]*0x01000193 ^ data[i]
	}
}

// generateDatasetItem combines data from 256 pseudorandomly selected cache nodes,
// and hashes that to compute a single dataset node.
func generateDatasetItem(cache []uint32, index uint32, keccak512 hasher) []byte {
	// Calculate the number of theoretical rows (we use one buffer nonetheless)
	rows := uint32(len(cache) / hashWords)

	// Initialize the mix
	mix := make([]byte, hashBytes)

	binary.LittleEndian.PutUint32(mix, cache[(index%rows)*hashWords]^index)
	for i := 1; i < hashWords; i++ {
		binary.LittleEndian.PutUint32(mix[i*4:], cache[(index%rows)*hashWords+uint32(i)])
	}
	keccak512(mix, mix)

	// Convert the mix to uint32s to avoid constant bit shifting
	intMix := make([]uint32, hashWords)
	for i := 0; i < len(intMix); i++ {
		intMix[i] = binary.LittleEndian.Uint32(mix[i*4:])
	}
	// fnv it with a lot of random cache nodes based on index
	for i := uint32(0); i < datasetParents; i++ {
		parent := fnv(index^i, intMix[i%16]) % rows
		fnvHash(intMix, cache[parent*hashWords:])
	}
	// Flatten the uint32 mix into a binary one and return
	for i, val := range intMix {
		binary.LittleEndian.PutUint32(mix[i*4:], val)
	}
	keccak512(mix, mix)
	return mix
}

// generateDataset generates the entire ethash dataset for mining.
// This method places the result into dest in machine byte order.
func generateDataset(dest []uint32, epoch uint64, cache []uint32) {
	// Print some debug logs to allow analysis on low end devices
	logger := log.New("epoch", epoch)

	start := time.Now()
	defer func() {
		elapsed := time.Since(start)

		logFn := logger.Debug
		if elapsed > 3*time.Second {
			logFn = logger.Info
		}
		logFn("Generated ethash verification cache", "elapsed", common.PrettyDuration(elapsed))
	}()

	// Figure out whether the bytes need to be swapped for the machine
	swapped := !isLittleEndian()

	// Convert our destination slice to a byte buffer
	header := *(*reflect.SliceHeader)(unsafe.Pointer(&dest))
	header.Len *= 4
	header.Cap *= 4
	dataset := *(*[]byte)(unsafe.Pointer(&header))

	// Generate the dataset on many goroutines since it takes a while
	threads := runtime.NumCPU()
	size := uint64(len(dataset))

	var pend sync.WaitGroup
	pend.Add(threads)

	var progress uint32
	for i := 0; i < threads; i++ {
		go func(id int) {
			defer pend.Done()

			// Create a hasher to reuse between invocations
			keccak512 := makeHasher(sha3.NewKeccak512())

			// Calculate the data segment this thread should generate
			batch := uint32((size + hashBytes*uint64(threads) - 1) / (hashBytes * uint64(threads)))
			first := uint32(id) * batch
			limit := first + batch
			if limit > uint32(size/hashBytes) {
				limit = uint32(size / hashBytes)
			}
			// Calculate the dataset segment
			percent := uint32(size / hashBytes / 100)
			for index := first; index < limit; index++ {
				item := generateDatasetItem(cache, index, keccak512)
				if swapped {
					swap(item)
				}
				copy(dataset[index*hashBytes:], item)

				if status := atomic.AddUint32(&progress, 1); status%percent == 0 {
					logger.Info("Generating DAG in progress", "percentage", uint64(status*100)/(size/hashBytes), "elapsed", common.PrettyDuration(time.Since(start)))
				}
			}
		}(i)
	}
	// Wait for all the generators to finish and return
	pend.Wait()
}

// hashimoto aggregates data from the full dataset in order to produce our final
// value for a particular header hash and nonce.
func hashimoto(hash []byte, nonce uint64, size uint64, lookup func(index uint32) []uint32) ([]byte, []byte) {
	// Calculate the number of theoretical rows (we use one buffer nonetheless)
	rows := uint32(size / mixBytes)

	// Combine header+nonce into a 64 byte seed
	seed := make([]byte, 40)
	copy(seed, hash)
	binary.LittleEndian.PutUint64(seed[32:], nonce)

	seed = crypto.Keccak512(seed)
	seedHead := binary.LittleEndian.Uint32(seed)

	// Start the mix with replicated seed
	mix := make([]uint32, mixBytes/4)
	for i := 0; i < len(mix); i++ {
		mix[i] = binary.LittleEndian.Uint32(seed[i%16*4:])
	}
	// Mix in random dataset nodes
	temp := make([]uint32, len(mix))

	for i := 0; i < loopAccesses; i++ {
		parent := fnv(uint32(i)^seedHead, mix[i%len(mix)]) % rows
		for j := uint32(0); j < mixBytes/hashBytes; j++ {
			copy(temp[j*hashWords:], lookup(2*parent+j))
		}
		fnvHash(mix, temp)
	}
	// Compress mix
	for i := 0; i < len(mix); i += 4 {
		mix[i/4] = fnv(fnv(fnv(mix[i], mix[i+1]), mix[i+2]), mix[i+3])
	}
	mix = mix[:len(mix)/4]

	digest := make([]byte, common.HashLength)
	for i, val := range mix {
		binary.LittleEndian.PutUint32(digest[i*4:], val)
	}
	return digest, crypto.Keccak256(append(seed, digest...))
}

// hashimotoLight aggregates data from the full dataset (using only a small
// in-memory cache) in order to produce our final value for a particular header
// hash and nonce.
func hashimotoLight(size uint64, cache []uint32, hash []byte, nonce uint64) ([]byte, []byte) {
	keccak512 := makeHasher(sha3.NewKeccak512())

	lookup := func(index uint32) []uint32 {
		rawData := generateDatasetItem(cache, index, keccak512)

		data := make([]uint32, len(rawData)/4)
		for i := 0; i < len(data); i++ {
			data[i] = binary.LittleEndian.Uint32(rawData[i*4:])
		}
		return data
	}
	return hashimoto(hash, nonce, size, lookup)
}

// hashimotoFull aggregates data from the full dataset (using the full in-memory
// dataset) in order to produce our final value for a particular header hash and
// nonce.
func hashimotoFull(dataset []uint32, hash []byte, nonce uint64) ([]byte, []byte) {
	lookup := func(index uint32) []uint32 {
		offset := index * hashWords
		return dataset[offset : offset+hashWords]
	}
	return hashimoto(hash, nonce, uint64(len(dataset))*4, lookup)
}

// datasetSizes is a lookup table for the ethash dataset size for the first 2048
// epochs (i.e. 61440000 blocks).
var datasetSizes = []uint64{
	16777088, 16784512, 16789888, 16800128, 16809088,
    16816768, 16825472, 16834432, 16842368, 16850048,
    16859008, 16866688, 16875392, 16883072, 16890752,
    16898432, 16905088, 16916096, 16921472, 16932736,
    16940416, 16948352, 16956032, 16965248, 16973696,
    16981376, 16988288, 16993664, 17006464, 17012608,
    17022592, 17030528, 17038976, 17047424, 17054848,
    17062784, 17068928, 17080192, 17087872, 17095552,
    17104768, 17112448, 17117824, 17128064, 17136256,
    17145472, 17151872, 17161856, 17168512, 17178496,
    17186432, 17194624, 17203072, 17208704, 17217664,
    17227648, 17233792, 17242496, 17251456, 17259392,
    17268352, 17273728, 17283712, 17292928, 17299328,
    17308288, 17316224, 17325184, 17332352, 17341312,
    17348224, 17358464, 17365888, 17375104, 17382272,
    17389952, 17398912, 17405312, 17415296, 17422208,
    17432192, 17439616, 17448832, 17456512, 17465216,
    17473408, 17481344, 17487488, 17496704, 17504384,
    17512064, 17521792, 17529728, 17535872, 17547136,
    17554816, 17562752, 17571712, 17579648, 17587072,
    17593984, 17602432, 17612416, 17620352, 17628544,
    17637248, 17644672, 17652608, 17661824, 17669248,
    17677696, 17684864, 17694592, 17700992, 17708672,
    17718656, 17727104, 17735552, 17742976, 17751424,
    17758592, 17766272, 17775232, 17783936, 17789056,
    17800576, 17809024, 17817472, 17822848, 17832064,
    17841536, 17848192, 17857408, 17865088, 17872256,
    17882752, 17889152, 17899136, 17907328, 17915776,
    17921152, 17929088, 17940352, 17948288, 17955968,
    17964928, 17972608, 17981056, 17988224, 17997184,
    18004864, 18013568, 18022016, 18030464, 18036352,
    18046592, 18053248, 18061696, 18071168, 18078848,
    18087808, 18095488, 18104192, 18111872, 18118528,
    18128512, 18136192, 18141568, 18151808, 18159488,
    18168448, 18176896, 18184576, 18191744, 18200704,
    18210688, 18217856, 18226048, 18233984, 18240128,
    18251648, 18255232, 18267008, 18274688, 18283648,
    18292096, 18300544, 18303104, 18315904, 18324352,
    18329216, 18341248, 18349696, 18357632, 18365824,
    18374528, 18381952, 18390656, 18399104, 18407296,
    18410624, 18420352, 18431872, 18439808, 18445184,
    18454144, 18464384, 18471808, 18481024, 18488192,
    18497408, 18504832, 18512512, 18521728, 18529664,
    18538112, 18545792, 18552448, 18562688, 18568832,
    18577792, 18587264, 18594176, 18599296, 18611072,
    18620288, 18627968, 18635392, 18644608, 18652544,
    18659456, 18666112, 18675584, 18684032, 18692224,
    18700672, 18710144, 18718592, 18726272, 18733952,
    18742144, 18749056, 18757504, 18766976, 18775424,
    18783872, 18791296, 18797696, 18808448, 18814592,
    18822016, 18829696, 18841216, 18849664, 18856832,
    18866048, 18873728, 18882176, 18890624, 18898816,
    18906752, 18914944, 18921856, 18928768, 18937472,
    18946688, 18955648, 18964096, 18970496, 18979712,
    18987392, 18996608, 19004288, 19012736, 19018112,
    19029632, 19037056, 19045504, 19054208, 19062656,
    19070848, 19078784, 19087232, 19095424, 19102592,
    19111552, 19119488, 19126144, 19136384, 19144064,
    19152512, 19160192, 19169152, 19174784, 19183744,
    19192192, 19201408, 19209856, 19216768, 19225984,
    19231616, 19242112, 19249024, 19256192, 19266944,
    19275392, 19283072, 19290496, 19299712, 19308416,
    19316096, 19323776, 19331456, 19339648, 19348864,
    19355264, 19364992, 19373696, 19382144, 19389824,
    19398272, 19405952, 19414144, 19421824, 19430272,
    19439488, 19444352, 19452032, 19464064, 19471744,
    19480192, 19487872, 19495808, 19504768, 19512704,
    19520128, 19528576, 19537792, 19543168, 19554176,
    19561088, 19568512, 19578752, 19584128, 19593856,
    19603328, 19608448, 19619456, 19627904, 19636096,
    19644032, 19652224, 19659392, 19667072, 19676032,
    19681664, 19691648, 19700864, 19705984, 19717504,
    19726208, 19732352, 19741312, 19750784, 19756928,
    19766144, 19775104, 19781504, 19791488, 19799168,
    19807616, 19815296, 19824256, 19832704, 19840384,
    19848832, 19855232, 19864448, 19872128, 19881856,
    19889536, 19897984, 19905152, 19914368, 19920256,
    19930496, 19938944, 19946624, 19954304, 19957888,
    19970432, 19979392, 19988096, 19995776, 20002432,
    20012416, 20015488, 20027776, 20036992, 20044928,
    20053888, 20061824, 20070272, 20075648, 20084864,
    20093312, 20102528, 20109952, 20119168, 20127616,
    20135296, 20142464, 20151424, 20158592, 20167808,
    20176256, 20182912, 20191616, 20201344, 20208256,
    20217728, 20225152, 20233856, 20242304, 20249728,
    20258432, 20266112, 20274304, 20281472, 20291456,
    20299648, 20306816, 20313472, 20323456, 20331904,
    20340352, 20346752, 20354944, 20364416, 20373376,
    20381056, 20389504, 20396672, 20405888, 20412544,
    20421248, 20427392, 20438144, 20446592, 20454272,
    20463488, 20471168, 20477312, 20486272, 20494976,
    20503424, 20512384, 20520832, 20527744, 20536448,
    20544896, 20550784, 20561792, 20569216, 20576896,
    20586112, 20593024, 20599424, 20610176, 20619136,
    20627072, 20633728, 20642176, 20651648, 20660096,
    20668288, 20675968, 20684672, 20692352, 20699776,
    20708224, 20715392, 20724608, 20733824, 20738176,
    20749952, 20754304, 20765312, 20773504, 20781952,
    20789632, 20799104, 20807296, 20815744, 20823424,
    20832128, 20837248, 20845952, 20855936, 20864384,
    20872064, 20880512, 20889472, 20897152, 20905856,
    20910976, 20919424, 20930176, 20937344, 20946304,
    20953216, 20962688, 20968832, 20979328, 20982656,
    20994944, 21003904, 21011072, 21018752, 21027712,
    21035648, 21044864, 21053056, 21059968, 21068672,
    21076864, 21085312, 21092992, 21099392, 21108608,
    21118336, 21126272, 21133184, 21143168, 21151616,
    21159808, 21166976, 21175936, 21181312, 21191552,
    21198976, 21206144, 21215872, 21224576, 21233536,
    21241216, 21249664, 21256064, 21260672, 21274496,
    21281152, 21288832, 21299072, 21306496, 21310336,
    21321088, 21330304, 21337984, 21348224, 21356416,
    21364352, 21372544, 21380992, 21388672, 21396352,
    21404288, 21410432, 21419648, 21430144, 21437824,
    21445504, 21454208, 21462656, 21469312, 21478528,
    21486464, 21493376, 21502336, 21509504, 21520256,
    21523328, 21536384, 21541504, 21549184, 21559424,
    21567872, 21575552, 21584768, 21593216, 21601408,
    21606784, 21618304, 21624704, 21634432, 21642112,
    21651328, 21657472, 21665152, 21675904, 21683072,
    21692288, 21699968, 21707648, 21716608, 21722752,
    21732992, 21739904, 21749632, 21754496, 21766016,
    21774208, 21781376, 21790592, 21798272, 21806464,
    21812864, 21821824, 21831296, 21837952, 21845632,
    21855872, 21864064, 21871744, 21878656, 21888896,
    21894784, 21904768, 21910912, 21921664, 21928576,
    21937024, 21945472, 21954176, 21962624, 21970048,
    21978496, 21985664, 21993856, 22001792, 22009216,
    22019968, 22027904, 22036096, 22044544, 22052224,
    22060928, 22068608, 22072448, 22085248, 22093696,
    22100864, 22108288, 22116736, 22125952, 22129024,
    22142336, 22150784, 22156672, 22167424, 22172032,
    22183552, 22189952, 22199168, 22208128, 22215808,
    22224512, 22231936, 22239104, 22248832, 22254976,
    22263424, 22272896, 22282112, 22290304, 22297216,
    22305664, 22314368, 22321792, 22330496, 22339456,
    22346624, 22355584, 22361984, 22370944, 22378112,
    22388096, 22394752, 22404992, 22413184, 22418048,
    22429312, 22437248, 22444672, 22452608, 22461568,
    22469504, 22476928, 22486144, 22493056, 22500224,
    22509952, 22517632, 22527104, 22536064, 22543744,
    22552448, 22559104, 22568576, 22577024, 22583168,
    22593152, 22601344, 22608512, 22617472, 22624384,
    22632832, 22641536, 22649728, 22658432, 22661504,
    22672768, 22683008, 22690432, 22699136, 22705024,
    22715776, 22724224, 22731392, 22738816, 22744448,
    22757248, 22763648, 22773376, 22781312, 22788992,
    22797184, 22805632, 22813568, 22822528, 22830208,
    22837376, 22846592, 22855552, 22863488, 22871168,
    22873216, 22888064, 22896256, 22904192, 22910336,
    22919296, 22927232, 22934144, 22945408, 22953856,
    22961024, 22969984, 22978432, 22986368, 22993024,
    23000704, 23007872, 23018624, 23027584, 23034496,
    23042944, 23049856, 23057536, 23068288, 23076736,
    23084416, 23092864, 23100544, 23109248, 23112832,
    23125376, 23133568, 23142272, 23148416, 23156096,
    23162752, 23172992, 23179136, 23191424, 23199104,
    23206784, 23214208, 23224192, 23232128, 23238784,
    23247232, 23256704, 23265152, 23272064, 23279744,
    23288704, 23297408, 23303552, 23314048, 23321728,
    23329408, 23338624, 23345792, 23353984, 23362432,
    23371136, 23379584, 23387264, 23395712, 23403392,
    23411072, 23420032, 23428736, 23435648, 23445376,
    23449984, 23460992, 23468672, 23474816, 23486336,
    23491456, 23502208, 23508608, 23515264, 23526016,
    23535488, 23541632, 23549312, 23559296, 23566976,
    23576192, 23582848, 23591552, 23599232, 23609216,
    23617408, 23625088, 23633024, 23641984, 23648384,
    23658368, 23664512, 23674496, 23682688, 23689856,
    23699072, 23704192, 23714176, 23721856, 23731328,
    23739776, 23748224, 23756672, 23763328, 23772544,
    23780992, 23788672, 23797376, 23804288, 23813248,
    23821696, 23828864, 23838592, 23846528, 23851904,
    23861632, 23869568, 23878528, 23887232, 23894912,
    23903104, 23910272, 23920256, 23925376, 23936384,
    23944832, 23953024, 23960704, 23966336, 23974784,
    23985536, 23992448, 24001664, 24009344, 24017792,
    24027008, 24033664, 24041344, 24050816, 24059264,
    24067712, 24067712, 24084352, 24089216, 24099968,
    24108928, 24116096, 24124544, 24132224, 24141184,
    24147584, 24157312, 24165248, 24174464, 24182656,
    24189824, 24197504, 24200576, 24213632, 24222592,
    24231808, 24238208, 24248192, 24255104, 24263552,
    24271232, 24280448, 24288896, 24297344, 24305536,
    24313472, 24319616, 24328064, 24336512, 24346496,
    24354688, 24362368, 24370048, 24372352, 24386944,
    24395648, 24403072, 24411776, 24420224, 24427904,
    24436352, 24437888, 24452992, 24460672, 24468608,
    24477568, 24483968, 24493184, 24500864, 24508544,
    24518528, 24524672, 24534656, 24539776, 24550784,
    24558208, 24566912, 24575872, 24582784, 24591488,
    24600448, 24608128, 24616832, 24625024, 24631168,
    24639872, 24649088, 24657536, 24665216, 24674176,
    24680576, 24689792, 24697472, 24705664, 24713344,
    24722816, 24729728, 24737408, 24747136, 24754304,
    24764032, 24769664, 24780416, 24788864, 24797056,
    24804992, 24812416, 24818048, 24829312, 24835456,
    24844928, 24853376, 24862592, 24866432, 24877184,
    24887168, 24893824, 24901504, 24909952, 24919936,
    24927872, 24936064, 24943232, 24951424, 24958592,
    24969088, 24976768, 24985216, 24993152, 25000832,
    25009792, 25016704, 25025408, 25034368, 25036672,
    25050752, 25057408, 25064576, 25074304, 25083776,
    25088384, 25099136, 25108352, 25113728, 25123712,
    25131136, 25137536, 25149056, 25157504, 25164416,
    25172864, 25181056, 25190272, 25197184, 25206656,
    25214848, 25220224, 25230976, 25236608, 25247104,
    25255808, 25263488, 25270144, 25277312, 25288576,
    25295488, 25304192, 25313152, 25319296, 25329536,
    25337216, 25345664, 25353344, 25361792, 25369216,
    25377152, 25385344, 25394816, 25403264, 25408384,
    25419392, 25426816, 25436032, 25442432, 25451648,
    25459328, 25468288, 25476992, 25485184, 25491584,
    25499008, 25508992, 25517696, 25525376, 25534336,
    25538944, 25549184, 25558912, 25566848, 25575296,
    25581184, 25591424, 25599872, 25608064, 25614976,
    25624448, 25630336, 25638016, 25649024, 25656704,
    25661824, 25673344, 25681792, 25689472, 25693568,
    25703296, 25714048, 25718912, 25729408, 25737344,
    25747328, 25755008, 25760128, 25771136, 25779584,
    25785728, 25794176, 25804672, 25812608, 25818752,
    25829248, 25836416, 25845632, 25853312, 25859968,
    25869952, 25872512, 25885568, 25893248, 25902208,
    25908352, 25919104, 25926272, 25935488, 25942912,
    25952128, 25958272, 25968512, 25975424, 25983872,
    25991296, 25998976, 26007424, 26015872, 26025344,
    26033536, 26041472, 26043008, 26058112, 26066048,
    26069632, 26082944, 26089088, 26098816, 26105984,
    26114944, 26120576, 26131328, 26134144, 26144128,
    26154368, 26162816, 26171008, 26178688, 26188928,
    26197376, 26205824, 26214016, 26221952, 26230144,
    26237824, 26245504, 26254208, 26261888, 26270336,
    26279296, 26285696, 26295424, 26303104, 26311552,
    26320256, 26324864, 26337152, 26345344, 26353024,
    26361728, 26369152, 26377856, 26383744, 26393984,
    26401664, 26406784, 26419072, 26427008, 26435456,
    26438528, 26451328, 26457472, 26468224, 26473856,
    26484608, 26489984, 26500736, 26506112, 26513792,
    26525056, 26533504, 26539904, 26548352, 26557568,
    26566528, 26571904, 26582912, 26591104, 26598272,
    26607232, 26615168, 26623616, 26631296, 26639488,
    26648192, 26656384, 26664832, 26672512, 26680448,
    26689408, 26694784, 26704768, 26713472, 26721152,
    26727296, 26738048, 26743424, 26754688, 26761088,
    26770816, 26779264, 26786432, 26794624, 26803328,
    26812288, 26820224, 26828416, 26836352, 26844032,
    26852992, 26860928, 26869376, 26877824, 26884736,
    26893952, 26902144, 26909824, 26918272, 26926208,
    26933888, 26942848, 26951296, 26959232, 26965888,
    26974592, 26983808, 26991232, 27000704, 27008896,
    27016576, 27024512, 27033472, 27039616, 27048832,
    27055744, 27064448, 27072896, 27082624, 27090304,
    27099008, 27103616, 27112576, 27122048, 27129472,
    27139712, 27146368, 27154048, 27162752, 27171968,
    27174016, 27188608, 27197312, 27200896, 27211904,
    27221888, 27225728, 27237248, 27244928, 27254144,
    27262336, 27269504, 27279232, 27287168, 27295616,
    27303296, 27310208, 27316096, 27326848, 27335296,
    27343744, 27348352, 27360128, 27369088, 27377536,
    27385472, 27393152, 27400832, 27410048, 27416192,
    27425152, 27431552, 27443072, 27451264, 27458432,
    27467392, 27475328, 27480448, 27492224, 27498368,
    27506048, 27515776, 27519104, 27531136, 27540608,
    27545216, 27555712, 27565952, 27573376, 27581824,
    27587968, 27595136, 27604352, 27614336, 27622528,
    27630464, 27638656, 27645824, 27655808, 27664256,
    27670912, 27677824, 27688832, 27696512, 27703168,
    27713152, 27721088, 27726976, 27737984, 27745408,
    27754112, 27760256, 27769216, 27776384, 27786368,
    27791488, 27802496, 27810688, 27819392, 27826816,
    27835264, 27842432, 27850112, 27860608, 27869056,
    27875968, 27884672, 27892352, 27901568, 27910016,
    27918208, 27925888, 27933824, 27940736, 27950464,
    27958144, 27965312, 27974528, 27983744, 27991168,
    27999872, 28007552, 28015744, 28024448, 28032128,
    28041088, 28049024, 28055936, 28064128, 28072064,
    28081792, 28089728, 28098176, 28105856, 28114816,
    28122496, 28130176, 28139392, 28145792, 28154752,
    28162688, 28168064, 28179328, 28187776, 28195712,
    28204928, 28212608, 28220288, 28229504, 28235392,
    28245376, 28252288, 28261504, 28270208, 28277632,
    28284544, 28294016, 28300928, 28310144, 28318592,
    28327808, 28329856, 28340864, 28351616, 28360576,
    28367744, 28374656, 28383616, 28392064, 28399744,
    28409728, 28417408, 28425344, 28433536, 28441472,
    28450432, 28458112, 28465792, 28475008, 28483456,
    28491136, 28498816, 28507264, 28515712, 28523648,
    28529024, 28539776, 28548736, 28557184, 28563328,
    28573312, 28581248, 28587392, 28598144, 28605568,
    28614272, 28619392, 28630912, 28635008, 28643968,
    28652672, 28661888, 28671872, 28679296, 28686464,
    28694656, 28704128, 28712576, 28718464, 28728704,
    28736128, 28744832, 28753024, 28761472, 28769152,
    28778368, 28786048, 28793728, 28802944, 28810112,
    28819072, 28821376, 28833664, 28843904, 28849024,
    28859008, 28867712, 28874624, 28881536, 28892288,
    28899968, 28907392, 28917632, 28925824, 28931456,
    28941184, 28949632, 28957568, 28964224, 28974976,
    28982656, 28990336, 28998784, 29007488, 29013632,
    29022848, 29032064, 29039488, 29048704, 29054848,
    29062784, 29072768, 29080448, 29088896, 29094784,
    29105536, 29113984, 29122432, 29130368, 29136512,
    29146496, 29151104, 29161856, 29170304, 29177728,
    29186944, 29193856, 29201792, 29212544, 29219968,
    29227648, 29236352, 29245312, 29252992, 29260928,
    29266816, 29277824, 29286272, 29293952, 29302144,
    29310592, 29316736, 29323904, 29335168, 29343616,
    29351552, 29359744, 29367424, 29375872, 29383808,
    29392768, 29400704, 29409152, 29416832, 29420672,
    29433472, 29440384, 29449856, 29458304, 29465984,
    29472896, 29481856, 29490304, 29497984, 29504896,
    29512576, 29523584, 29532032, 29539712, 29546624,
    29554048, 29564032, 29571968, 29578112, 29584768,
    29596544, 29605504, 29613952, 29621632, 29629568,
    29638528, 29646464, 29654656, 29660032, 29670272,
    29679488, 29686144, 29691776, 29702528, 29710976,
    29720192, 29723776, 29735296, 29744768, 29752192,
    29759872, 29769088, 29777024, 29785472, 29792384,
    29801344, 29810048, 29815936, 29826688, 29834624,
    29842304, 29849728, 29859712, 29867648, 29876096,
    29879936, 29889152, 29900672, 29908864, 29915264,
    29923456, 29932928, 29941376, 29949824, 29957504,
    29965184, 29973376, 29982592, 29989504, 29998208,
    30007168, 30012544, 30022016, 30030464, 30039424,
    30047872, 30055808, 30063232, 30071168, 30080896,
    30088832, 30094976, 30105472, 30111104, 30119552,
    30127232, 30137216, 30146432, 30153856, 30159488,
    30169472, 30176128, 30184064, 30195328, 30203776,
    30210688, 30219136, 30227584, 30236032, 30244736,
    30251392, 30260096, 30269312, 30275456, 30281344,
    30292352, 30301312, 30308224, 30312064, 30325376,
    30333824, 30342784, 30347648, 30358912, 30365824,
    30374528, 30383744, 30388352, 30398336, 30408064,
    30416768, 30424448, 30431872, 30441088, 30449024,
    30454912, 30465152, 30474112, 30482048, 30490496,
    30498176, 30506368, 30514816, 30523264, 30530432,
    30539648, 30547072, 30554752, 30563968, 30571648,
    30578816, 30587776, 30595456, 30603136, 30613376,
    30621568, 30628736, 30637696, 30646144, 30651008,
    30661504, 30670208, 30677888, 30686336, 30695296,
    30701696, 30711424, 30719872, 30727552, 30734464,
    30742144, 30746752, 30760832, 30768512, 30775936,
    30785152, 30793088, 30800768, 30809728, 30817664,
    30826112, 30834304, 30842752, 30849664, 30858112,
    30866048, 30874496, 30882688, 30891904, 30898304,
    30908032, 30914176, 30924416, 30932864, 30941056,
    30948224, 30956416, 30965632, 30973568, 30977152,
    30988928, 30998144, 31005056, 31011712, 31021696,
    31029632, 31038848, 31046528, 31055488, 31063168,
    31071616, 31080064, 31087744, 31094656, 31103872,
    31107968, 31119488, 31129216, 31137664, 31143808,
    31154048, 31159936, 31170176, 31178624, 31186816,
    31194752, 31202432, 31211392, 31217792, 31225984,
    31234688, 31243648, 31252352, 31260032, 31265408,
    31276928, 31284608, 31292288, 31299712, 31309184,
    31317632, 31325824, 31332736, 31342208, 31347328,
    31354496, 31364992, 31373696, 31383424, 31386752,
    31398272, 31403392, 31415936, 31424128, 31432064,
    31440512, 31447424, 31457152, 31465088, 31472768,
    31480448, 31489408, 31497344, 31505024, 31513984,
    31522688, 31530112, 31538048, 31544192, 31555456,
    31561856, 31570304, 31579264, 31587968, 31595392,
    31604096, 31612288, 31619968, 31628672, 31634048,
    31645312, 31651712, 31659904, 31669888, 31675264,
    31686016, 31694464, 31699328, 31710592, 31718272,
    31725184, 31732864, 31743872, 31752064, 31759232,
    31768192, 31775104, 31784576, 31791488, 31801216,
    31809152, 31816832, 31825792, 31833728, 31840384,
    31849856, 31858304, 31860352, 31874176, 31882112,
    31890304, 31899008, 31904896, 31915648, 31922816,
    31931264, 31940224, 31947904, 31956352, 31965056,
    31971712, 31981184, 31988608, 31996544, 32005504,
    32013952, 32021632, 32025472, 32038528, 32046208,
    32054144, 32062592, 32069504, 32079232, 32087936,
    32096128, 32104064, 32111488, 32117632, 32128384,
    32137088, 32142976, 32153216, 32161664, 32169344,
    32177536, 32184704, 32194432, 32200576, 32209792,
    32218496, 32225408, 32234624, 32243584, 32249216,
    32259712, 32266112, 32276096, 32284544, 32292224,
    32299648, 32308352, 32315264, 32325248, 32333696,
    32341376, 32349568, 32355712, 32362112, 32373632,
    32381824, 32390272, 32397952, 32404352, 32415616,
    32423296, 32431232, 32440192, 32448128, 32456576,
    32462464, 32471168, 32480128, 32489344, 32496512,
    32505728, 32512384, 32521088, 32530048, 32538496,
    32544896, 32554112, 32561792, 32571008, 32578432,
    32583296, 32594816, 32603264, 32612224, 32618624,
    32628608, 32636288, 32642944, 32652416, 32659072,
    32667776, 32673152, 32684672, 32693632, 32702336,
    32710528, 32718464, 32726912, 32735104, 32742784,
    32751232, 32758144, 32766592, 32775296, 32783488,
    32792192, 32796032, 32808064, 32815232, 32824448,
    32831872, 32840576, 32849792, 32857472, 32864896,
    32874368, 32881792, 32890496, 32898176, 32905856,
    32914048, 32920192, 32930944, 32939392, 32948096,
    32954752, 32962432, 32971648, 32980096, 32987776,
    32997248, 33003136, 33011584, 33021568, 33027968,
    33037952, 33046144, 33053824, 33062272, 33069184,
    33077888, 33086848, 33094528, 33103744, 33110656,
    33119104, 33127552, 33135488, 33141632, 33152128,
    33156224, 33167744, 33175424, 33181312, 33193088,
    33201536, 33209984, 33218176, 33226624, 33234304,
    33241216, 33250688, 33259136, 33262976, 33275776,
    33282944, 33291392, 33297536, 33307264, 33314432,
    33323392, 33332864, 33339776, 33349504, 33355136,
    33365888, 33372544, 33381248, 33390464, 33397888,
    33406336, 33413504, 33420928, 33429632, 33438848,
    33446528, 33453184, 33464192, 33467776, 33480064,
    33488768, 33494144, 33504896, 33513344, 33521536}

// cacheSizes is a lookup table for the ethash verification cache size for the
// first 2048 epochs (i.e. 61440000 blocks).
var cacheSizes = []uint64{
	16776896, 16907456, 17039296, 17170112, 17301056, 17432512, 17563072,
	17693888, 17824192, 17955904, 18087488, 18218176, 18349504, 18481088,
	18611392, 18742336, 18874304, 19004224, 19135936, 19267264, 19398208,
	19529408, 19660096, 19791424, 19922752, 20053952, 20184896, 20315968,
	20446912, 20576576, 20709184, 20840384, 20971072, 21102272, 21233216,
	21364544, 21494848, 21626816, 21757376, 21887552, 22019392, 22151104,
	22281536, 22412224, 22543936, 22675264, 22806464, 22935872, 23068096,
	23198272, 23330752, 23459008, 23592512, 23723968, 23854912, 23986112,
	24116672, 24247616, 24378688, 24509504, 24640832, 24772544, 24903488,
	25034432, 25165376, 25296704, 25427392, 25558592, 25690048, 25820096,
	25951936, 26081728, 26214208, 26345024, 26476096, 26606656, 26737472,
	26869184, 26998208, 27131584, 27262528, 27393728, 27523904, 27655744,
	27786688, 27917888, 28049344, 28179904, 28311488, 28441792, 28573504,
	28700864, 28835648, 28966208, 29096768, 29228608, 29359808, 29490752,
	29621824, 29752256, 29882816, 30014912, 30144448, 30273728, 30406976,
	30538432, 30670784, 30799936, 30932672, 31063744, 31195072, 31325248,
	31456192, 31588288, 31719232, 31850432, 31981504, 32110784, 32243392,
	32372672, 32505664, 32636608, 32767808, 32897344, 33029824, 33160768,
	33289664, 33423296, 33554368, 33683648, 33816512, 33947456, 34076992,
	34208704, 34340032, 34471744, 34600256, 34734016, 34864576, 34993984,
	35127104, 35258176, 35386688, 35518528, 35650624, 35782336, 35910976,
	36044608, 36175808, 36305728, 36436672, 36568384, 36699968, 36830656,
	36961984, 37093312, 37223488, 37355072, 37486528, 37617472, 37747904,
	37879232, 38009792, 38141888, 38272448, 38403392, 38535104, 38660672,
	38795584, 38925632, 39059264, 39190336, 39320768, 39452096, 39581632,
	39713984, 39844928, 39974848, 40107968, 40238144, 40367168, 40500032,
	40631744, 40762816, 40894144, 41023552, 41155904, 41286208, 41418304,
	41547712, 41680448, 41811904, 41942848, 42073792, 42204992, 42334912,
	42467008, 42597824, 42729152, 42860096, 42991552, 43122368, 43253696,
	43382848, 43515712, 43646912, 43777088, 43907648, 44039104, 44170432,
	44302144, 44433344, 44564288, 44694976, 44825152, 44956864, 45088448,
	45219008, 45350464, 45481024, 45612608, 45744064, 45874496, 46006208,
	46136768, 46267712, 46399424, 46529344, 46660672, 46791488, 46923328,
	47053504, 47185856, 47316928, 47447872, 47579072, 47710144, 47839936,
	47971648, 48103232, 48234176, 48365248, 48496192, 48627136, 48757312,
	48889664, 49020736, 49149248, 49283008, 49413824, 49545152, 49675712,
	49807168, 49938368, 50069056, 50200256, 50331584, 50462656, 50593472,
	50724032, 50853952, 50986048, 51117632, 51248576, 51379904, 51510848,
	51641792, 51773248, 51903296, 52035136, 52164032, 52297664, 52427968,
	52557376, 52690112, 52821952, 52952896, 53081536, 53213504, 53344576,
	53475776, 53608384, 53738816, 53870528, 54000832, 54131776, 54263744,
	54394688, 54525248, 54655936, 54787904, 54918592, 55049152, 55181248,
	55312064, 55442752, 55574336, 55705024, 55836224, 55967168, 56097856,
	56228672, 56358592, 56490176, 56621888, 56753728, 56884928, 57015488,
	57146816, 57278272, 57409216, 57540416, 57671104, 57802432, 57933632,
	58064576, 58195264, 58326976, 58457408, 58588864, 58720192, 58849984,
	58981696, 59113024, 59243456, 59375552, 59506624, 59637568, 59768512,
	59897792, 60030016, 60161984, 60293056, 60423872, 60554432, 60683968,
	60817216, 60948032, 61079488, 61209664, 61341376, 61471936, 61602752,
	61733696, 61865792, 61996736, 62127808, 62259136, 62389568, 62520512,
	62651584, 62781632, 62910784, 63045056, 63176128, 63307072, 63438656,
	63569216, 63700928, 63831616, 63960896, 64093888, 64225088, 64355392,
	64486976, 64617664, 64748608, 64879424, 65009216, 65142464, 65273792,
	65402816, 65535424, 65666752, 65797696, 65927744, 66060224, 66191296,
	66321344, 66453056, 66584384, 66715328, 66846656, 66977728, 67108672,
	67239104, 67370432, 67501888, 67631296, 67763776, 67895104, 68026304,
	68157248, 68287936, 68419264, 68548288, 68681408, 68811968, 68942912,
	69074624, 69205568, 69337024, 69467584, 69599168, 69729472, 69861184,
	69989824, 70122944, 70253888, 70385344, 70515904, 70647232, 70778816,
	70907968, 71040832, 71171648, 71303104, 71432512, 71564992, 71695168,
	71826368, 71958464, 72089536, 72219712, 72350144, 72482624, 72613568,
	72744512, 72875584, 73006144, 73138112, 73268672, 73400128, 73530944,
	73662272, 73793344, 73924544, 74055104, 74185792, 74316992, 74448832,
	74579392, 74710976, 74841664, 74972864, 75102784, 75233344, 75364544,
	75497024, 75627584, 75759296, 75890624, 76021696, 76152256, 76283072,
	76414144, 76545856, 76676672, 76806976, 76937792, 77070016, 77200832,
	77331392, 77462464, 77593664, 77725376, 77856448, 77987776, 78118336,
	78249664, 78380992, 78511424, 78642496, 78773056, 78905152, 79033664,
	79166656, 79297472, 79429568, 79560512, 79690816, 79822784, 79953472,
	80084672, 80214208, 80346944, 80477632, 80608576, 80740288, 80870848,
	81002048, 81133504, 81264448, 81395648, 81525952, 81657536, 81786304,
	81919808, 82050112, 82181312, 82311616, 82443968, 82573376, 82705984,
	82835776, 82967744, 83096768, 83230528, 83359552, 83491264, 83622464,
	83753536, 83886016, 84015296, 84147776, 84277184, 84409792, 84540608,
	84672064, 84803008, 84934336, 85065152, 85193792, 85326784, 85458496,
	85589312, 85721024, 85851968, 85982656, 86112448, 86244416, 86370112,
	86506688, 86637632, 86769344, 86900672, 87031744, 87162304, 87293632,
	87424576, 87555392, 87687104, 87816896, 87947968, 88079168, 88211264,
	88341824, 88473152, 88603712, 88735424, 88862912, 88996672, 89128384,
	89259712, 89390272, 89521984, 89652544, 89783872, 89914816, 90045376,
	90177088, 90307904, 90438848, 90569152, 90700096, 90832832, 90963776,
	91093696, 91223744, 91356992, 91486784, 91618496, 91749824, 91880384,
	92012224, 92143552, 92273344, 92405696, 92536768, 92666432, 92798912,
	92926016, 93060544, 93192128, 93322816, 93453632, 93583936, 93715136,
	93845056, 93977792, 94109504, 94240448, 94371776, 94501184, 94632896,
	94764224, 94895552, 95023424, 95158208, 95287744, 95420224, 95550016,
	95681216, 95811904, 95943872, 96075328, 96203584, 96337856, 96468544,
	96599744, 96731072, 96860992, 96992576, 97124288, 97254848, 97385536,
	97517248, 97647808, 97779392, 97910464, 98041408, 98172608, 98303168,
	98434496, 98565568, 98696768, 98827328, 98958784, 99089728, 99220928,
	99352384, 99482816, 99614272, 99745472, 99876416, 100007104,
	100138048, 100267072, 100401088, 100529984, 100662592, 100791872,
	100925248, 101056064, 101187392, 101317952, 101449408, 101580608,
	101711296, 101841728, 101973824, 102104896, 102235712, 102366016,
	102498112, 102628672, 102760384, 102890432, 103021888, 103153472,
	103284032, 103415744, 103545152, 103677248, 103808576, 103939648,
	104070976, 104201792, 104332736, 104462528, 104594752, 104725952,
	104854592, 104988608, 105118912, 105247808, 105381184, 105511232,
	105643072, 105774784, 105903296, 106037056, 106167872, 106298944,
	106429504, 106561472, 106691392, 106822592, 106954304, 107085376,
	107216576, 107346368, 107478464, 107609792, 107739712, 107872192,
	108003136, 108131392, 108265408, 108396224, 108527168, 108657344,
	108789568, 108920384, 109049792, 109182272, 109312576, 109444928,
	109572928, 109706944, 109837888, 109969088, 110099648, 110230976,
	110362432, 110492992, 110624704, 110755264, 110886208, 111017408,
	111148864, 111279296, 111410752, 111541952, 111673024, 111803456,
	111933632, 112066496, 112196416, 112328512, 112457792, 112590784,
	112715968, 112852672, 112983616, 113114944, 113244224, 113376448,
	113505472, 113639104, 113770304, 113901376, 114031552, 114163264,
	114294592, 114425536, 114556864, 114687424, 114818624, 114948544,
	115080512, 115212224, 115343296, 115473472, 115605184, 115736128,
	115867072, 115997248, 116128576, 116260288, 116391488, 116522944,
	116652992, 116784704, 116915648, 117046208, 117178304, 117308608,
	117440192, 117569728, 117701824, 117833024, 117964096, 118094656,
	118225984, 118357312, 118489024, 118617536, 118749632, 118882112,
	119012416, 119144384, 119275328, 119406016, 119537344, 119668672,
	119798464, 119928896, 120061376, 120192832, 120321728, 120454336,
	120584512, 120716608, 120848192, 120979136, 121109056, 121241408,
	121372352, 121502912, 121634752, 121764416, 121895744, 122027072,
	122157632, 122289088, 122421184, 122550592, 122682944, 122813888,
	122945344, 123075776, 123207488, 123338048, 123468736, 123600704,
	123731264, 123861952, 123993664, 124124608, 124256192, 124386368,
	124518208, 124649024, 124778048, 124911296, 125041088, 125173696,
	125303744, 125432896, 125566912, 125696576, 125829056, 125958592,
	126090304, 126221248, 126352832, 126483776, 126615232, 126746432,
	126876608, 127008704, 127139392, 127270336, 127401152, 127532224,
	127663552, 127794752, 127925696, 128055232, 128188096, 128319424,
	128449856, 128581312, 128712256, 128843584, 128973632, 129103808,
	129236288, 129365696, 129498944, 129629888, 129760832, 129892288,
	130023104, 130154048, 130283968, 130416448, 130547008, 130678336,
	130807616, 130939456, 131071552, 131202112, 131331776, 131464384,
	131594048, 131727296, 131858368, 131987392, 132120256, 132250816,
	132382528, 132513728, 132644672, 132774976, 132905792, 133038016,
	133168832, 133299392, 133429312, 133562048, 133692992, 133823296,
	133954624, 134086336, 134217152, 134348608, 134479808, 134607296,
	134741056, 134872384, 135002944, 135134144, 135265472, 135396544,
	135527872, 135659072, 135787712, 135921472, 136052416, 136182848,
	136313792, 136444864, 136576448, 136707904, 136837952, 136970048,
	137099584, 137232064, 137363392, 137494208, 137625536, 137755712,
	137887424, 138018368, 138149824, 138280256, 138411584, 138539584,
	138672832, 138804928, 138936128, 139066688, 139196864, 139328704,
	139460032, 139590208, 139721024, 139852864, 139984576, 140115776,
	140245696, 140376512, 140508352, 140640064, 140769856, 140902336,
	141032768, 141162688, 141294016, 141426496, 141556544, 141687488,
	141819584, 141949888, 142080448, 142212544, 142342336, 142474432,
	142606144, 142736192, 142868288, 142997824, 143129408, 143258944,
	143392448, 143523136, 143653696, 143785024, 143916992, 144045632,
	144177856, 144309184, 144440768, 144570688, 144701888, 144832448,
	144965056, 145096384, 145227584, 145358656, 145489856, 145620928,
	145751488, 145883072, 146011456, 146144704, 146275264, 146407232,
	146538176, 146668736, 146800448, 146931392, 147062336, 147193664,
	147324224, 147455936, 147586624, 147717056, 147848768, 147979456,
	148110784, 148242368, 148373312, 148503232, 148635584, 148766144,
	148897088, 149028416, 149159488, 149290688, 149420224, 149551552,
	149683136, 149814976, 149943616, 150076352, 150208064, 150338624,
	150470464, 150600256, 150732224, 150862784, 150993088, 151125952,
	151254976, 151388096, 151519168, 151649728, 151778752, 151911104,
	152042944, 152174144, 152304704, 152435648, 152567488, 152698816,
	152828992, 152960576, 153091648, 153222976, 153353792, 153484096,
	153616192, 153747008, 153878336, 154008256, 154139968, 154270912,
	154402624, 154533824, 154663616, 154795712, 154926272, 155057984,
	155188928, 155319872, 155450816, 155580608, 155712064, 155843392,
	155971136, 156106688, 156237376, 156367424, 156499264, 156630976,
	156761536, 156892352, 157024064, 157155008, 157284416, 157415872,
	157545536, 157677248, 157810496, 157938112, 158071744, 158203328,
	158334656, 158464832, 158596288, 158727616, 158858048, 158988992,
	159121216, 159252416, 159381568, 159513152, 159645632, 159776192,
	159906496, 160038464, 160169536, 160300352, 160430656, 160563008,
	160693952, 160822208, 160956352, 161086784, 161217344, 161349184,
	161480512, 161611456, 161742272, 161873216, 162002752, 162135872,
	162266432, 162397888, 162529216, 162660032, 162790976, 162922048,
	163052096, 163184576, 163314752, 163446592, 163577408, 163707968,
	163839296, 163969984, 164100928, 164233024, 164364224, 164494912,
	164625856, 164756672, 164887616, 165019072, 165150016, 165280064,
	165412672, 165543104, 165674944, 165805888, 165936832, 166067648,
	166198336, 166330048, 166461248, 166591552, 166722496, 166854208,
	166985408, 167116736, 167246656, 167378368, 167508416, 167641024,
	167771584, 167903168, 168034112, 168164032, 168295744, 168427456,
	168557632, 168688448, 168819136, 168951616, 169082176, 169213504,
	169344832, 169475648, 169605952, 169738048, 169866304, 169999552,
	170131264, 170262464, 170393536, 170524352, 170655424, 170782016,
	170917696, 171048896, 171179072, 171310784, 171439936, 171573184,
	171702976, 171835072, 171966272, 172097216, 172228288, 172359232,
	172489664, 172621376, 172747712, 172883264, 173014208, 173144512,
	173275072, 173407424, 173539136, 173669696, 173800768, 173931712,
	174063424, 174193472, 174325696, 174455744, 174586816, 174718912,
	174849728, 174977728, 175109696, 175242688, 175374272, 175504832,
	175636288, 175765696, 175898432, 176028992, 176159936, 176291264,
	176422592, 176552512, 176684864, 176815424, 176946496, 177076544,
	177209152, 177340096, 177470528, 177600704, 177731648, 177864256,
	177994816, 178126528, 178257472, 178387648, 178518464, 178650176,
	178781888, 178912064, 179044288, 179174848, 179305024, 179436736,
	179568448, 179698496, 179830208, 179960512, 180092608, 180223808,
	180354752, 180485696, 180617152, 180748096, 180877504, 181009984,
	181139264, 181272512, 181402688, 181532608, 181663168, 181795136,
	181926592, 182057536, 182190016, 182320192, 182451904, 182582336,
	182713792, 182843072, 182976064, 183107264, 183237056, 183368384,
	183494848, 183631424, 183762752, 183893824, 184024768, 184154816,
	184286656, 184417984, 184548928, 184680128, 184810816, 184941248,
	185072704, 185203904, 185335616, 185465408, 185596352, 185727296,
	185859904, 185989696, 186121664, 186252992, 186383552, 186514112,
	186645952, 186777152, 186907328, 187037504, 187170112, 187301824,
	187429184, 187562048, 187693504, 187825472, 187957184, 188087104,
	188218304, 188349376, 188481344, 188609728, 188743616, 188874304,
	189005248, 189136448, 189265088, 189396544, 189528128, 189660992,
	189791936, 189923264, 190054208, 190182848, 190315072, 190447424,
	190577984, 190709312, 190840768, 190971328, 191102656, 191233472,
	191364032, 191495872, 191626816, 191758016, 191888192, 192020288,
	192148928, 192282176, 192413504, 192542528, 192674752, 192805952,
	192937792, 193068608, 193198912, 193330496, 193462208, 193592384,
	193723456, 193854272, 193985984, 194116672, 194247232, 194379712,
	194508352, 194641856, 194772544, 194900672, 195035072, 195166016,
	195296704, 195428032, 195558592, 195690304, 195818176, 195952576,
	196083392, 196214336, 196345792, 196476736, 196607552, 196739008,
	196869952, 197000768, 197130688, 197262784, 197394368, 197523904,
	197656384, 197787584, 197916608, 198049472, 198180544, 198310208,
	198442432, 198573632, 198705088, 198834368, 198967232, 199097792,
	199228352, 199360192, 199491392, 199621696, 199751744, 199883968,
	200014016, 200146624, 200276672, 200408128, 200540096, 200671168,
	200801984, 200933312, 201062464, 201194944, 201326144, 201457472,
	201588544, 201719744, 201850816, 201981632, 202111552, 202244032,
	202374464, 202505152, 202636352, 202767808, 202898368, 203030336,
	203159872, 203292608, 203423296, 203553472, 203685824, 203816896,
	203947712, 204078272, 204208192, 204341056, 204472256, 204603328,
	204733888, 204864448, 204996544, 205125568, 205258304, 205388864,
	205517632, 205650112, 205782208, 205913536, 206044736, 206176192,
	206307008, 206434496, 206569024, 206700224, 206831168, 206961856,
	207093056, 207223616, 207355328, 207486784, 207616832, 207749056,
	207879104, 208010048, 208141888, 208273216, 208404032, 208534336,
	208666048, 208796864, 208927424, 209059264, 209189824, 209321792,
	209451584, 209582656, 209715136, 209845568, 209976896, 210106432,
	210239296, 210370112, 210501568, 210630976, 210763712, 210894272,
	211024832, 211156672, 211287616, 211418176, 211549376, 211679296,
	211812032, 211942592, 212074432, 212204864, 212334016, 212467648,
	212597824, 212727616, 212860352, 212991424, 213120832, 213253952,
	213385024, 213515584, 213645632, 213777728, 213909184, 214040128,
	214170688, 214302656, 214433728, 214564544, 214695232, 214826048,
	214956992, 215089088, 215219776, 215350592, 215482304, 215613248,
	215743552, 215874752, 216005312, 216137024, 216267328, 216399296,
	216530752, 216661696, 216790592, 216923968, 217054528, 217183168,
	217316672, 217448128, 217579072, 217709504, 217838912, 217972672,
	218102848, 218233024, 218364736, 218496832, 218627776, 218759104,
	218888896, 219021248, 219151936, 219281728, 219413056, 219545024,
	219675968, 219807296, 219938624, 220069312, 220200128, 220331456,
	220461632, 220592704, 220725184, 220855744, 220987072, 221117888,
	221249216, 221378368, 221510336, 221642048, 221772736, 221904832,
	222031808, 222166976, 222297536, 222428992, 222559936, 222690368,
	222820672, 222953152, 223083968, 223213376, 223345984, 223476928,
	223608512, 223738688, 223869376, 224001472, 224132672, 224262848,
	224394944, 224524864, 224657344, 224788288, 224919488, 225050432,
	225181504, 225312704, 225443776, 225574592, 225704768, 225834176,
	225966784, 226097216, 226229824, 226360384, 226491712, 226623424,
	226754368, 226885312, 227015104, 227147456, 227278528, 227409472,
	227539904, 227669696, 227802944, 227932352, 228065216, 228196288,
	228326464, 228457792, 228588736, 228720064, 228850112, 228981056,
	229113152, 229243328, 229375936, 229505344, 229636928, 229769152,
	229894976, 230030272, 230162368, 230292416, 230424512, 230553152,
	230684864, 230816704, 230948416, 231079616, 231210944, 231342016,
	231472448, 231603776, 231733952, 231866176, 231996736, 232127296,
	232259392, 232388672, 232521664, 232652608, 232782272, 232914496,
	233043904, 233175616, 233306816, 233438528, 233569984, 233699776,
	233830592, 233962688, 234092224, 234221888, 234353984, 234485312,
	234618304, 234749888, 234880832, 235011776, 235142464, 235274048,
	235403456, 235535936, 235667392, 235797568, 235928768, 236057152,
	236190272, 236322752, 236453312, 236583616, 236715712, 236846528,
	236976448, 237108544, 237239104, 237371072, 237501632, 237630784,
	237764416, 237895232, 238026688, 238157632, 238286912, 238419392,
	238548032, 238681024, 238812608, 238941632, 239075008, 239206336,
	239335232, 239466944, 239599168, 239730496, 239861312, 239992384,
	240122816, 240254656, 240385856, 240516928, 240647872, 240779072,
	240909632, 241040704, 241171904, 241302848, 241433408, 241565248,
	241696192, 241825984, 241958848, 242088256, 242220224, 242352064,
	242481856, 242611648, 242744896, 242876224, 243005632, 243138496,
	243268672, 243400384, 243531712, 243662656, 243793856, 243924544,
	244054592, 244187072, 244316608, 244448704, 244580032, 244710976,
	244841536, 244972864, 245104448, 245233984, 245365312, 245497792,
	245628736, 245759936, 245889856, 246021056, 246152512, 246284224,
	246415168, 246545344, 246675904, 246808384, 246939584, 247070144,
	247199552, 247331648, 247463872, 247593536, 247726016, 247857088,
	247987648, 248116928, 248249536, 248380736, 248512064, 248643008,
	248773312, 248901056, 249036608, 249167552, 249298624, 249429184,
	249560512, 249692096, 249822784, 249954112, 250085312, 250215488,
	250345792, 250478528, 250608704, 250739264, 250870976, 251002816,
	251133632, 251263552, 251395136, 251523904, 251657792, 251789248,
	251919424, 252051392, 252182464, 252313408, 252444224, 252575552,
	252706624, 252836032, 252968512, 253099712, 253227584, 253361728,
	253493056, 253623488, 253754432, 253885504, 254017216, 254148032,
	254279488, 254410432, 254541376, 254672576, 254803264, 254933824,
	255065792, 255196736, 255326528, 255458752, 255589952, 255721408,
	255851072, 255983296, 256114624, 256244416, 256374208, 256507712,
	256636096, 256768832, 256900544, 257031616, 257162176, 257294272,
	257424448, 257555776, 257686976, 257818432, 257949632, 258079552,
	258211136, 258342464, 258473408, 258603712, 258734656, 258867008,
	258996544, 259127744, 259260224, 259391296, 259522112, 259651904,
	259784384, 259915328, 260045888, 260175424, 260308544, 260438336,
	260570944, 260700992, 260832448, 260963776, 261092672, 261226304,
	261356864, 261487936, 261619648, 261750592, 261879872, 262011968,
	262143424, 262274752, 262404416, 262537024, 262667968, 262799296,
	262928704, 263061184, 263191744, 263322944, 263454656, 263585216,
	263716672, 263847872, 263978944, 264108608, 264241088, 264371648,
	264501184, 264632768, 264764096, 264895936, 265024576, 265158464,
	265287488, 265418432, 265550528, 265681216, 265813312, 265943488,
	266075968, 266206144, 266337728, 266468032, 266600384, 266731072,
	266862272, 266993344, 267124288, 267255616, 267386432, 267516992,
	267648704, 267777728, 267910592, 268040512, 268172096, 268302784,
	268435264, 268566208, 268696256, 268828096, 268959296, 269090368,
	269221312, 269352256, 269482688, 269614784, 269745856, 269876416,
	270007616, 270139328, 270270272, 270401216, 270531904, 270663616,
	270791744, 270924736, 271056832, 271186112, 271317184, 271449536,
	271580992, 271711936, 271843136, 271973056, 272105408, 272236352,
	272367296, 272498368, 272629568, 272759488, 272891456, 273022784,
	273153856, 273284672, 273415616, 273547072, 273677632, 273808448,
	273937088, 274071488, 274200896, 274332992, 274463296, 274595392,
	274726208, 274857536, 274988992, 275118656, 275250496, 275382208,
	275513024, 275643968, 275775296, 275906368, 276037184, 276167872,
	276297664, 276429376, 276560576, 276692672, 276822976, 276955072,
	277085632, 277216832, 277347008, 277478848, 277609664, 277740992,
	277868608, 278002624, 278134336, 278265536, 278395328, 278526784,
	278657728, 278789824, 278921152, 279052096, 279182912, 279313088,
	279443776, 279576256, 279706048, 279838528, 279969728, 280099648,
	280230976, 280361408, 280493632, 280622528, 280755392, 280887104,
	281018176, 281147968, 281278912, 281411392, 281542592, 281673152,
	281803712, 281935552, 282066496, 282197312, 282329024, 282458816,
	282590272, 282720832, 282853184, 282983744, 283115072, 283246144,
	283377344, 283508416, 283639744, 283770304, 283901504, 284032576,
	284163136, 284294848, 284426176, 284556992, 284687296, 284819264,
	284950208, 285081536}
