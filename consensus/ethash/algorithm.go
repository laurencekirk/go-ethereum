// Copyright 2017 The go-ethereum Authors
// This file is part of the go-ethereum library.
//
// The go-ethereum library is free software: you can redistribute it and/or modify
// it under the terms of the GNU Lesser General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
//
// The go-ethereum library is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
// GNU Lesser General Public License for more details.
//
// You should have received a copy of the GNU Lesser General Public License
// along with the go-ethereum library. If not, see <http://www.gnu.org/licenses/>.

package ethash

import (
	"encoding/binary"
	"hash"
	"reflect"
	"runtime"
	"sync"
	"sync/atomic"
	"time"
	"unsafe"

	"github.com/ethereum/go-ethereum/common"
	"github.com/ethereum/go-ethereum/common/bitutil"
	"github.com/ethereum/go-ethereum/crypto"
	"github.com/ethereum/go-ethereum/crypto/sha3"
	"github.com/ethereum/go-ethereum/log"
)

const (
	datasetInitBytes   = 1 << 24 // Bytes in dataset at genesis (~168 MB)
	datasetGrowthBytes = 1 << 23 // Dataset growth per epoch
	cacheInitBytes     = 1 << 24 // Bytes in cache at genesis
	cacheGrowthBytes   = 1 << 17 // Cache growth per epoch
	epochLength        = 30000   // Blocks per epoch
	mixBytes           = 128     // Width of mix
	hashBytes          = 64      // Hash length in bytes
	hashWords          = 16      // Number of 32 bit ints in a hash
	datasetParents     = 256     // Number of parents of each dataset element
	cacheRounds        = 3       // Number of rounds in cache production
	loopAccesses       = 64      // Number of accesses in hashimoto loop
)

// hasher is a repetitive hasher allowing the same hash data structures to be
// reused between hash runs instead of requiring new ones to be created.
type hasher func(dest []byte, data []byte)

// makeHasher creates a repetitive hasher, allowing the same hash data structures
// to be reused between hash runs instead of requiring new ones to be created.
// The returned function is not thread safe!
func makeHasher(h hash.Hash) hasher {
	return func(dest []byte, data []byte) {
		h.Write(data)
		h.Sum(dest[:0])
		h.Reset()
	}
}

// seedHash is the seed to use for generating a verification cache and the mining
// dataset.
func seedHash(block uint64) []byte {
	seed := make([]byte, 32)
	if block < epochLength {
		return seed
	}
	keccak256 := makeHasher(sha3.NewKeccak256())
	for i := 0; i < int(block/epochLength); i++ {
		keccak256(seed, seed)
	}
	return seed
}

// generateCache creates a verification cache of a given size for an input seed.
// The cache production process involves first sequentially filling up 32 MB of
// memory, then performing two passes of Sergio Demian Lerner's RandMemoHash
// algorithm from Strict Memory Hard Hashing Functions (2014). The output is a
// set of 524288 64-byte values.
// This method places the result into dest in machine byte order.
func generateCache(dest []uint32, epoch uint64, seed []byte) {
	// Print some debug logs to allow analysis on low end devices
	logger := log.New("epoch", epoch)

	start := time.Now()
	defer func() {
		elapsed := time.Since(start)

		logFn := logger.Debug
		if elapsed > 3*time.Second {
			logFn = logger.Info
		}
		logFn("Generated ethash verification cache", "elapsed", common.PrettyDuration(elapsed))
	}()
	// Convert our destination slice to a byte buffer
	header := *(*reflect.SliceHeader)(unsafe.Pointer(&dest))
	header.Len *= 4
	header.Cap *= 4
	cache := *(*[]byte)(unsafe.Pointer(&header))

	// Calculate the number of theoretical rows (we'll store in one buffer nonetheless)
	size := uint64(len(cache))
	rows := int(size) / hashBytes

	// Start a monitoring goroutine to report progress on low end devices
	var progress uint32

	done := make(chan struct{})
	defer close(done)

	go func() {
		for {
			select {
			case <-done:
				return
			case <-time.After(3 * time.Second):
				logger.Info("Generating ethash verification cache", "percentage", atomic.LoadUint32(&progress)*100/uint32(rows)/4, "elapsed", common.PrettyDuration(time.Since(start)))
			}
		}
	}()
	// Create a hasher to reuse between invocations
	keccak512 := makeHasher(sha3.NewKeccak512())

	// Sequentially produce the initial dataset
	keccak512(cache, seed)
	for offset := uint64(hashBytes); offset < size; offset += hashBytes {
		keccak512(cache[offset:], cache[offset-hashBytes:offset])
		atomic.AddUint32(&progress, 1)
	}
	// Use a low-round version of randmemohash
	temp := make([]byte, hashBytes)

	for i := 0; i < cacheRounds; i++ {
		for j := 0; j < rows; j++ {
			var (
				srcOff = ((j - 1 + rows) % rows) * hashBytes
				dstOff = j * hashBytes
				xorOff = (binary.LittleEndian.Uint32(cache[dstOff:]) % uint32(rows)) * hashBytes
			)
			bitutil.XORBytes(temp, cache[srcOff:srcOff+hashBytes], cache[xorOff:xorOff+hashBytes])
			keccak512(cache[dstOff:], temp)

			atomic.AddUint32(&progress, 1)
		}
	}
	// Swap the byte order on big endian systems and return
	if !isLittleEndian() {
		swap(cache)
	}
}

// swap changes the byte order of the buffer assuming a uint32 representation.
func swap(buffer []byte) {
	for i := 0; i < len(buffer); i += 4 {
		binary.BigEndian.PutUint32(buffer[i:], binary.LittleEndian.Uint32(buffer[i:]))
	}
}

// prepare converts an ethash cache or dataset from a byte stream into the internal
// int representation. All ethash methods work with ints to avoid constant byte to
// int conversions as well as to handle both little and big endian systems.
func prepare(dest []uint32, src []byte) {
	for i := 0; i < len(dest); i++ {
		dest[i] = binary.LittleEndian.Uint32(src[i*4:])
	}
}

// fnv is an algorithm inspired by the FNV hash, which in some cases is used as
// a non-associative substitute for XOR. Note that we multiply the prime with
// the full 32-bit input, in contrast with the FNV-1 spec which multiplies the
// prime with one byte (octet) in turn.
func fnv(a, b uint32) uint32 {
	return a*0x01000193 ^ b
}

// fnvHash mixes in data into mix using the ethash fnv method.
func fnvHash(mix []uint32, data []uint32) {
	for i := 0; i < len(mix); i++ {
		mix[i] = mix[i]*0x01000193 ^ data[i]
	}
}

// generateDatasetItem combines data from 256 pseudorandomly selected cache nodes,
// and hashes that to compute a single dataset node.
func generateDatasetItem(cache []uint32, index uint32, keccak512 hasher) []byte {
	// Calculate the number of theoretical rows (we use one buffer nonetheless)
	rows := uint32(len(cache) / hashWords)

	// Initialize the mix
	mix := make([]byte, hashBytes)

	binary.LittleEndian.PutUint32(mix, cache[(index%rows)*hashWords]^index)
	for i := 1; i < hashWords; i++ {
		binary.LittleEndian.PutUint32(mix[i*4:], cache[(index%rows)*hashWords+uint32(i)])
	}
	keccak512(mix, mix)

	// Convert the mix to uint32s to avoid constant bit shifting
	intMix := make([]uint32, hashWords)
	for i := 0; i < len(intMix); i++ {
		intMix[i] = binary.LittleEndian.Uint32(mix[i*4:])
	}
	// fnv it with a lot of random cache nodes based on index
	for i := uint32(0); i < datasetParents; i++ {
		parent := fnv(index^i, intMix[i%16]) % rows
		fnvHash(intMix, cache[parent*hashWords:])
	}
	// Flatten the uint32 mix into a binary one and return
	for i, val := range intMix {
		binary.LittleEndian.PutUint32(mix[i*4:], val)
	}
	keccak512(mix, mix)
	return mix
}

// generateDataset generates the entire ethash dataset for mining.
// This method places the result into dest in machine byte order.
func generateDataset(dest []uint32, epoch uint64, cache []uint32) {
	// Print some debug logs to allow analysis on low end devices
	logger := log.New("epoch", epoch)

	start := time.Now()
	defer func() {
		elapsed := time.Since(start)

		logFn := logger.Debug
		if elapsed > 3*time.Second {
			logFn = logger.Info
		}
		logFn("Generated ethash verification cache", "elapsed", common.PrettyDuration(elapsed))
	}()

	// Figure out whether the bytes need to be swapped for the machine
	swapped := !isLittleEndian()

	// Convert our destination slice to a byte buffer
	header := *(*reflect.SliceHeader)(unsafe.Pointer(&dest))
	header.Len *= 4
	header.Cap *= 4
	dataset := *(*[]byte)(unsafe.Pointer(&header))

	// Generate the dataset on many goroutines since it takes a while
	threads := runtime.NumCPU()
	size := uint64(len(dataset))

	var pend sync.WaitGroup
	pend.Add(threads)

	var progress uint32
	for i := 0; i < threads; i++ {
		go func(id int) {
			defer pend.Done()

			// Create a hasher to reuse between invocations
			keccak512 := makeHasher(sha3.NewKeccak512())

			// Calculate the data segment this thread should generate
			batch := uint32((size + hashBytes*uint64(threads) - 1) / (hashBytes * uint64(threads)))
			first := uint32(id) * batch
			limit := first + batch
			if limit > uint32(size/hashBytes) {
				limit = uint32(size / hashBytes)
			}
			// Calculate the dataset segment
			percent := uint32(size / hashBytes / 100)
			for index := first; index < limit; index++ {
				item := generateDatasetItem(cache, index, keccak512)
				if swapped {
					swap(item)
				}
				copy(dataset[index*hashBytes:], item)

				if status := atomic.AddUint32(&progress, 1); status%percent == 0 {
					logger.Info("Generating DAG in progress", "percentage", uint64(status*100)/(size/hashBytes), "elapsed", common.PrettyDuration(time.Since(start)))
				}
			}
		}(i)
	}
	// Wait for all the generators to finish and return
	pend.Wait()
}

// hashimoto aggregates data from the full dataset in order to produce our final
// value for a particular header hash and nonce.
func hashimoto(hash []byte, nonce uint64, size uint64, lookup func(index uint32) []uint32) ([]byte, []byte) {
	// Calculate the number of theoretical rows (we use one buffer nonetheless)
	rows := uint32(size / mixBytes)

	// Combine header+nonce into a 64 byte seed
	seed := make([]byte, 40)
	copy(seed, hash)
	binary.LittleEndian.PutUint64(seed[32:], nonce)

	seed = crypto.Keccak512(seed)
	seedHead := binary.LittleEndian.Uint32(seed)

	// Start the mix with replicated seed
	mix := make([]uint32, mixBytes/4)
	for i := 0; i < len(mix); i++ {
		mix[i] = binary.LittleEndian.Uint32(seed[i%16*4:])
	}
	// Mix in random dataset nodes
	temp := make([]uint32, len(mix))

	for i := 0; i < loopAccesses; i++ {
		parent := fnv(uint32(i)^seedHead, mix[i%len(mix)]) % rows
		for j := uint32(0); j < mixBytes/hashBytes; j++ {
			copy(temp[j*hashWords:], lookup(2*parent+j))
		}
		fnvHash(mix, temp)
	}
	// Compress mix
	for i := 0; i < len(mix); i += 4 {
		mix[i/4] = fnv(fnv(fnv(mix[i], mix[i+1]), mix[i+2]), mix[i+3])
	}
	mix = mix[:len(mix)/4]

	digest := make([]byte, common.HashLength)
	for i, val := range mix {
		binary.LittleEndian.PutUint32(digest[i*4:], val)
	}
	return digest, crypto.Keccak256(append(seed, digest...))
}

// hashimotoLight aggregates data from the full dataset (using only a small
// in-memory cache) in order to produce our final value for a particular header
// hash and nonce.
func hashimotoLight(size uint64, cache []uint32, hash []byte, nonce uint64) ([]byte, []byte) {
	keccak512 := makeHasher(sha3.NewKeccak512())

	lookup := func(index uint32) []uint32 {
		rawData := generateDatasetItem(cache, index, keccak512)

		data := make([]uint32, len(rawData)/4)
		for i := 0; i < len(data); i++ {
			data[i] = binary.LittleEndian.Uint32(rawData[i*4:])
		}
		return data
	}
	return hashimoto(hash, nonce, size, lookup)
}

// hashimotoFull aggregates data from the full dataset (using the full in-memory
// dataset) in order to produce our final value for a particular header hash and
// nonce.
func hashimotoFull(dataset []uint32, hash []byte, nonce uint64) ([]byte, []byte) {
	lookup := func(index uint32) []uint32 {
		offset := index * hashWords
		return dataset[offset : offset+hashWords]
	}
	return hashimoto(hash, nonce, uint64(len(dataset))*4, lookup)
}

// datasetSizes is a lookup table for the ethash dataset size for the first 2048
// epochs (i.e. 61440000 blocks).
var datasetSizes = []uint64{
	10737399, 10821303, 10905148, 10989067, 11072930,
	11156842, 11240700, 11324619, 11408495, 11492327,
	11576277, 11660138, 11744047, 11827869, 11911804,
	11995685, 12079589, 12163452, 12247320, 12331247,
	12415133, 12499024, 12582903, 12666737, 12750672,
	12834533, 12918449, 13002341, 13086199, 13170100,
	13253973, 13337877, 13421761, 13505616, 13589543,
	13673393, 13757315, 13841181, 13925070, 14008974,
	14092847, 14176733, 14260624, 14344510, 14428391,
	14512290, 14596156, 14680060, 14763941, 14847829,
	14931715, 15015591, 15099480, 15183376, 15267265,
	15351146, 15435034, 15518920, 15602786, 15686690,
	15770563, 15854462, 15938312, 16022193, 16106103,
	16190001, 16273867, 16357738, 16441642, 16525556,
	16609434, 16693326, 16777212, 16861093, 16944976,
	17028862, 17112746, 17196611, 17280477, 17364348,
	17448290, 17532189, 17616062, 17699959, 17783824,
	17867728, 17951578, 18035505, 18119376, 18203275,
	18287115, 18371029, 18454887, 18538799, 18622693,
	18706568, 18790480, 18874315, 18958250, 19042120,
	19126012, 19209885, 19293794, 19377655, 19461566,
	19545432, 19629320, 19713217, 19797072, 19880930,
	19964875, 20048746, 20132622, 20216538, 20300399,
	20384308, 20468199, 20552085, 20635966, 20719819,
	20803736, 20887627, 20971490, 21055397, 21139285,
	21223151, 21307006, 21390926, 21474832, 21558721,
	21642576, 21726421, 21810353, 21894260, 21978149,
	22062030, 22145872, 22229797, 22313678, 22397582,
	22481450, 22565277, 22649227, 22733121, 22817012,
	22900862, 22984766, 23068670, 23152510, 23236391,
	23320321, 23404202, 23488080, 23571964, 23655804,
	23739669, 23823630, 23907485, 23991399, 24075303,
	24159189, 24243073, 24326954, 24410842, 24494723,
	24578612, 24662478, 24746371, 24830268, 24914141,
	24998037, 25081918, 25165822, 25249703, 25333592,
	25417434, 25501341, 25585250, 25669134, 25753015,
	25836865, 25920738, 26004673, 26088561, 26172404,
	26256316, 26340220, 26424075, 26507964, 26591883,
	26675749, 26759653, 26843528, 26927386, 27011306,
	27095184, 27179073, 27262933, 27346850, 27430731,
	27514620, 27598516, 27682328, 27766255, 27850177,
	27934019, 28017944, 28101820, 28185716, 28269594,
	28353493, 28437341, 28521214, 28605144, 28689009,
	28772867, 28856769, 28940696, 29024515, 29108430,
	29192346, 29276227, 29360116, 29444007, 29527893,
	29611777, 29695655, 29779516, 29863389, 29947313,
	30031202, 30115083, 30198959, 30282871, 30366759,
	30450638, 30534529, 30618376, 30702283, 30786154,
	30870037, 30953949, 31037822, 31121731, 31205620,
	31289447, 31373392, 31457250, 31541093, 31625050,
	31708931, 31792802, 31876693, 31960567, 32044455,
	32128367, 32212240, 32296129, 32380023, 32463911,
	32547784, 32631658, 32715562, 32799445, 32883324,
	32967192, 33051109, 33135000, 33218871, 33302731,
	33386589, 33470531, 33554405, 33638270, 33722202,
	33806083, 33889975, 33973845, 34057742, 34141630,
	34225519, 34309379, 34393283, 34477141, 34561045,
	34644939, 34728835, 34812688, 34896551, 34980488,
	35064344, 35148263, 35232139, 35316035, 35399870,
	35483802, 35567632, 35651572, 35735453, 35819344,
	35903240, 35987127, 36070987, 36154883, 36238772,
	36322658, 36406465, 36490435, 36574301, 36658215,
	36742078, 36825975, 36909848, 36993678, 37077643,
	37161524, 37245410, 37329255, 37413180, 37497063,
	37580911, 37664815, 37748727, 37832600, 37916504,
	38000362, 38084276, 38168154, 38252046, 38335927,
	38419815, 38503704, 38587559, 38671479, 38755362,
	38839205, 38923137, 39007025, 39090878, 39174787,
	39258684, 39342565, 39426453, 39510321, 39594223,
	39678091, 39762000, 39845884, 39929749, 40013635,
	40097511, 40181413, 40265304, 40349116, 40433089,
	40516954, 40600843, 40684724, 40768628, 40852494,
	40936405, 41020284, 41104136, 41188056, 41271944,
	41355831, 41439719, 41523608, 41607461, 41691357,
	41775258, 41859127, 41943036, 42026919, 42110767,
	42194635, 42278554, 42362466, 42446337, 42530228,
	42614122, 42697998, 42781848, 42865780, 42949623,
	43033496, 43117431, 43201304, 43285210, 43369091,
	43452954, 43536874, 43620734, 43704584, 43788527,
	43872385, 43956302, 44040190, 44124074, 44207906,
	44291828, 44375714, 44459621, 44543440, 44627380,
	44711192, 44795165, 44879041, 44962896, 45046823,
	45130684, 45214595, 45298461, 45382327, 45466197,
	45550101, 45634021, 45717902, 45801744, 45885679,
	45969570, 46053448, 46137340, 46221198, 46305114,
	46388988, 46472879, 46556752, 46640656, 46724519,
	46808426, 46892314, 46976203, 47060074, 47143970,
	47227861, 47311732, 47395623, 47479517, 47563406,
	47647279, 47731144, 47815043, 47898947, 47982836,
	48066676, 48150595, 48234494, 48318357, 48402261,
	48486122, 48570033, 48653914, 48737800, 48821697,
	48905573, 48989469, 49073332, 49157223, 49241109,
	49324993, 49408897, 49492760, 49576664, 49660547,
	49744380, 49828314, 49912213, 49996071, 50079988,
	50163864, 50247637, 50331646, 50415445, 50499418,
	50583297, 50667170, 50751074, 50834942, 50918839,
	51002735, 51086621, 51170481, 51254360, 51338274,
	51422152, 51506051, 51589930, 51673821, 51757694,
	51841575, 51925438, 52009360, 52093249, 52177112,
	52261026, 52344904, 52428773, 52512638, 52596540,
	52680408, 52764343, 52848193, 52932097, 53015985,
	53099866, 53183747, 53267644, 53351514, 53435421,
	53519294, 53603198, 53687069, 53770965, 53854849,
	53938712, 54022634, 54106504, 54190403, 54274269,
	54358165, 54442059, 54525948, 54609813, 54693679,
	54777608, 54861487, 54945368, 55029259, 55113153,
	55197034, 55280899, 55364811, 55448695, 55532560,
	55616456, 55700327, 55784239, 55868112, 55951932,
	56035854, 56119727, 56203662, 56287504, 56371439,
	56455281, 56539214, 56623102, 56706947, 56790826,
	56874740, 56958644, 57042510, 57126414, 57210302,
	57294168, 57378062, 57461943, 57545839, 57629699,
	57713585, 57797482, 57881378, 57965274, 58049112,
	58133006, 58216925, 58300821, 58384689, 58468555,
	58552474, 58636360, 58720244, 58804110, 58887998,
	58971864, 59055768, 59139669, 59223527, 59307447,
	59391322, 59475224, 59559112, 59642993, 59726882,
	59810743, 59894654, 59978510, 60062414, 60146279,
	60230155, 60314082, 60397960, 60481852, 60565748,
	60649634, 60733518, 60817360, 60901287, 60985176,
	61069064, 61152892, 61236808, 61320700, 61404596,
	61488490, 61572373, 61656247, 61740097, 61824037,
	61907920, 61991760, 62075697, 62159522, 62243452,
	62327325, 62411242, 62495102, 62578991, 62662877,
	62746768, 62830657, 62914543, 62998434, 63082320,
	63166209, 63250062, 63333955, 63417847, 63501748,
	63585621, 63669512, 63753378, 63837295, 63921191,
	64005041, 64088956, 64172834, 64256733, 64340591,
	64424446, 64508373, 64592234, 64676130, 64760042,
	64843930, 64927819, 65011700, 65095550, 65179470,
	65263363, 65347255, 65431128, 65515006, 65598887,
	65682786, 65766629, 65850556, 65934434, 66018341,
	66102196, 66186103, 66269991, 66353854, 66437774,
	66521642, 66605528, 66689419, 66773300, 66857194,
	66941077, 67024935, 67108821, 67192741, 67276629,
	67360520, 67444376, 67528259, 67612138, 67696042,
	67779938, 67863834, 67947708, 68031581, 68115493,
	68199376, 68283265, 68367061, 68451016, 68534913,
	68618804, 68702693, 68786551, 68870462, 68954333,
	69038222, 69122128, 69205968, 69289882, 69373771,
	69457649, 69541492, 69625442, 69709287, 69793173,
	69877093, 69960938, 70044872, 70128753, 70212586,
	70296523, 70380389, 70464277, 70548189, 70632078,
	70715951, 70799809, 70883726, 70967594, 71051498,
	71135368, 71219280, 71303153, 71386996, 71470923,
	71554791, 71638657, 71722499, 71806480, 71890366,
	71974247, 72058108, 72141966, 72225898, 72309751,
	72393675, 72477559, 72561455, 72645333, 72729214,
	72813080, 72896948, 72980888, 73064718, 73148645,
	73232538, 73316430, 73400295, 73484197, 73568088,
	73651966, 73735857, 73819738, 73903627, 73987505,
	74071389, 74155285, 74239156, 74323022, 74406903,
	74490801, 74574721, 74658609, 74742490, 74826356,
	74910237, 74994126, 75078030, 75161923, 75245799,
	75329672, 75413584, 75497457, 75581346, 75665240,
	75749128, 75833009, 75916901, 76000751, 76084668,
	76168549, 76252445, 76336298, 76420209, 76504103,
	76587941, 76671873, 76755749, 76839619, 76923495,
	77007397, 77091303, 77175192, 77259055, 77342954,
	77426832, 77510690, 77594574, 77678490, 77762382,
	77846268, 77930149, 78014053, 78097921, 78181799,
	78265711, 78349571, 78433473, 78517323, 78601245,
	78685123, 78769020, 78852878, 78936797, 79020670,
	79104559, 79188442, 79272308, 79356227, 79440093,
	79524002, 79607860, 79691767, 79775653, 79859534,
	79943399, 80027303, 80111194, 80195080, 80278961,
	80362850, 80446746, 80530622, 80614488, 80698384,
	80782273, 80866167, 80950065, 81033936, 81117835,
	81201713, 81285602, 81369493, 81453367, 81537268,
	81621149, 81705032, 81788919, 81872807, 81956696,
	82040584, 82124445, 82208341, 82292222, 82376126,
	82460007, 82543893, 82627751, 82711671, 82795536,
	82879440, 82963331, 83047151, 83131083, 83214979,
	83298855, 83382744, 83466632, 83550529, 83634415,
	83718283, 83802179, 83886065, 83969962, 84053845,
	84137726, 84221615, 84305493, 84389390, 84473265,
	84557154, 84641048, 84724929, 84808820, 84892706,
	84976597, 85060453, 85144349, 85228238, 85312088,
	85396023, 85479906, 85563787, 85647683, 85731541,
	85815427, 85899339, 85983228, 86067050, 86150992,
	86234878, 86318769, 86402640, 86486539, 86570402,
	86654306, 86738205, 86822091, 86905921, 86989771,
	87073744, 87157633, 87241514, 87325400, 87409283,
	87493157, 87577045, 87660893, 87744807, 87828719,
	87912600, 87996458, 88080344, 88164263, 88248129,
	88331994, 88415914, 88499764, 88583663, 88667572,
	88751471, 88835329, 88919233, 89003068, 89087002,
	89170883, 89254787, 89338673, 89422503, 89506446,
	89590327, 89674205, 89758096, 89841975, 89925840,
	90009762, 90093620, 90177524, 90261413, 90345306,
	90429175, 90513079, 90596942, 90680848, 90764714,
	90848618, 90932506, 91016385, 91100276, 91184165,
	91268035, 91351880, 91435813, 91519696, 91603562,
	91687471, 91771344, 91855256, 91939101, 92023028,
	92106906, 92190795, 92274653, 92358544, 92442448,
	92526334, 92610218, 92694114, 92777992, 92861889,
	92945742, 93029658, 93113519, 93197400, 93281319,
	93365167, 93449073, 93532967, 93616858, 93700747,
	93784636, 93868494, 93952398, 94036291, 94120165,
	94204053, 94287950, 94371815, 94455706, 94539608,
	94623466, 94707380, 94791215, 94875150, 94959036,
	95042896, 95126785, 95210679, 95294562, 95378435,
	95462337, 95546213, 95630114, 95713987, 95797886,
	95881783, 95965671, 96049544, 96133431, 96217329,
	96301218, 96385084, 96468988, 96552835, 96636757,
	96720613, 96804496, 96888400, 96972304, 97056175,
	97140035, 97223939, 97307726, 97391722, 97475610,
	97559453, 97643388, 97727261, 97811165, 97895038,
	97978929, 98062826, 98146704, 98230565, 98314392,
	98398339, 98482243, 98566135, 98650005, 98733912,
	98817724, 98901628, 98985562, 99069405, 99153332,
	99237210, 99321086, 99404965, 99488884, 99572765,
	99656661, 99740483, 99824410, 99908304, 99992195,
	100076028, 100159965, 100243851, 100327740, 100411636,
	100495489, 100579400, 100663294, 100747178, 100831051,
	100914952, 100998787, 101082722, 101166606, 101250492,
	101334373, 101418256, 101502135, 101586010, 101669912,
	101753788, 101837661, 101921573, 102005454, 102089355,
	102173221, 102257127, 102340993, 102424894, 102508760,
	102592648, 102676560, 102760426, 102844291, 102928203,
	103012094, 103095988, 103179877, 103263752, 103347633,
	103431535, 103515416, 103599307, 103683185, 103767074,
	103850965, 103934846, 104018671, 104102621, 104186474,
	104270391, 104354256, 104438101, 104522036, 104605899,
	104689821, 104773694, 104857591, 104941477, 105025335,
	105109233, 105193135, 105277026, 105360912, 105444785,
	105528677, 105612558, 105696423, 105780327, 105864231,
	105948056, 106032001, 106115889, 106199760, 106283613,
	106367540, 106451434, 106535317, 106619203, 106703079,
	106786968, 106870864, 106954750, 107038631, 107122461,
	107206396, 107290266, 107374147, 107458062, 107541909,
	107625813, 107709712, 107793562, 107877474, 107961355,
	108045251, 108129155, 108213018, 108296922, 108380783,
	108464692, 108548583, 108632472, 108716314, 108800234,
	108884120, 108967996, 109051889, 109135740, 109219646,
	109303527, 109387429, 109471325, 109555185, 109639095,
	109722983, 109806874, 109890748, 109974629, 110058517,
	110142411, 110226277, 110310173, 110394039, 110477930,
	110561847, 110645707, 110729608, 110813438, 110897378,
	110981282, 111065148, 111149044, 111232935, 111316801,
	111400651, 111484583, 111568456, 111652368, 111736241,
	111820138, 111904026, 111987907, 112071791, 112155687,
	112239573, 112323457, 112407345, 112491226, 112575112,
	112658996, 112742859, 112826755, 112910654, 112994525,
	113078424, 113162312, 113246168, 113330090, 113413955,
	113497826, 113581722, 113665603, 113749500, 113833396,
	113917218, 114001173, 114085041, 114168935, 114252834,
	114336715, 114420611, 114504446, 114588378, 114672267,
	114756117, 114840039, 114923920, 115007806, 115091690,
	115175509, 115259444, 115343356, 115427242, 115511118,
	115595006, 115678903, 115762773, 115846670, 115930561,
	116014434, 116098300, 116182219, 116266074, 116349950,
	116433877, 116517751, 116601616, 116685525, 116769409,
	116853303, 116937186, 117021064, 117104961, 117188826,
	117272730, 117356604, 117440500, 117524373, 117608247,
	117692161, 117776047, 117859912, 117943819, 118027700,
	118111578, 118195485, 118279325, 118363247, 118447133,
	118531009, 118614864, 118698799, 118782680, 118866568,
	118950449, 119034330, 119118229, 119202108, 119286004,
	119369872, 119453758, 119537611, 119621512, 119705434,
	119789285, 119873204, 119957082, 120040951, 120124862,
	120208751, 120292555, 120376520, 120460391, 120544295,
	120628138, 120712065, 120795946, 120879837, 120963710,
	121047599, 121131472, 121215345, 121299249, 121383146,
	121467032, 121550915, 121634812, 121718647, 121802558,
	121886439, 121970341, 122054245, 122138113, 122221994,
	122305903, 122389776, 122473652, 122557553, 122641434,
	122725315, 122809204, 122893095, 122976945, 123060865,
	123144753, 123228650, 123312536, 123396404, 123480293,
	123564189, 123648052, 123731966, 123815809, 123899690,
	123983576, 124067505, 124151384, 124235275, 124319164,
	124403045, 124486923, 124570812, 124654677, 124738599,
	124822455, 124906366, 124990255, 125074115, 125158017,
	125241905, 125325771, 125409662, 125493543, 125577432,
	125661295, 125745232, 125829118, 125912994, 125996880,
	126080746, 126164634, 126248456, 126332399, 126416316,
	126500199, 126584072, 126667951, 126751832, 126835746,
	126919601, 127003505, 127087402, 127171285, 127255159,
	127339068, 127422951, 127506801, 127590718, 127674607,
	127758488, 127842369, 127926268, 128010146, 128094042,
	128177893, 128261815, 128345688, 128429546, 128513457,
	128597323, 128681224, 128765121, 128849012, 128932890,
	129016728, 129100675, 129184551, 129268424, 129352328,
	129436207, 129520098, 129603969, 129687868, 129771761,
	129855637, 129939511, 130023415, 130107303, 130191153,
	130275063, 130358951, 130442725, 130526731, 130610625,
	130694462, 130778389, 130862270, 130946136, 131030001,
	131113936, 131197825, 131281575, 131365592, 131449450,
	131533295, 131617242, 131701118, 131785027, 131868847,
	131952797, 132036670, 132120574, 132204458, 132288321,
	132372212, 132456106, 132540005, 132623883, 132707774,
	132791663, 132875534, 132959432, 133043319, 133127194,
	133211080, 133294946, 133378858, 133462749, 133546638,
	133630511, 133714392, 133798250, 133882108, 133966050,
	134049954, 134133802, 134217713, 134301597, 134385460,
	134469372, 134553268, 134637082, 134721038, 134804926,
	134888756, 134972698, 135056577, 135140453, 135224357,
	135308245, 135392101, 135475992, 135559893, 135643790,
	135727663, 135811544, 135895448, 135979329, 136063205,
	136147106, 136230974, 136314776, 136398749, 136482640,
	136566529, 136650417, 136734306, 136818184, 136902076,
	136985957, 137069822, 137153731, 137237620, 137321501,
	137405367, 137489265, 137573162, 137657009, 137740901,
	137824779, 137908693, 137992590, 138076478, 138160367,
	138244253, 138328142, 138412023, 138495914, 138579787,
	138663688, 138747546, 138831453, 138915331, 138999192,
	139083111, 139166920, 139250850, 139334731, 139418663,
	139502536, 139586435, 139670321, 139754172, 139838076,
	139921975, 140005822, 140089736, 140173630, 140257521,
	140341379, 140425283, 140509180, 140593015, 140676916,
	140760835, 140844701, 140928523, 141012496, 141096359,
	141180248, 141264075, 141348043, 141431886, 141515779,
	141599683, 141683572, 141767415, 141851272, 141935210,
	142019114, 142103018, 142186850, 142270672, 142354673,
	142438554, 142522430, 142606301, 142690215, 142774094,
	142857992, 142941879, 143025713, 143109617, 143193537,
	143277387, 143361309, 143445187, 143529063, 143612965,
	143696853, 143780714, 143864625, 143948481, 144032308,
	144116273, 144200139, 144284023, 144367934, 144451815,
	144535696, 144619598, 144703479, 144787370, 144871228,
	144955114, 145039018, 145122917, 145206775, 145290648,
	145374567, 145458456, 145542344, 145626184, 145710114,
	145793987, 145877891, 145961726, 146045646, 146129539,
	146213413, 146297242, 146381208, 146465032, 146548975,
	146632848, 146716752, 146800610, 146884476, 146968359,
	147052284, 147136167, 147220033, 147303921, 147387841,
	147471727, 147555610, 147639476, 147723365, 147807253,
	147891101, 147974997, 148058927, 148142769, 148226702,
	148310562, 148394443, 148478360, 148562228, 148646129,
	148729975, 148813886, 148897757, 148981653, 149065534,
	149149448, 149233296, 149317218, 149401096, 149484970,
	149568874, 149652765, 149736636, 149820532, 149904398,
	149988309, 150072167, 150156058, 150239952, 150323851,
	150407683, 150491549, 150575491, 150659390, 150743284,
	150827150, 150911041, 150994935, 151078792, 151162691,
	151246595, 151330423, 151414319, 151498243, 151582142,
	151666023, 151749912, 151833783, 151917605, 152001544,
	152085425, 152169317, 152253233, 152337084, 152420980,
	152504892, 152588752, 152672654, 152756545, 152840431,
	152924314, 153008195, 153092081, 153175965, 153259861,
	153343747, 153427636, 153511517, 153595406, 153679297,
	153763183, 153847064, 153930929, 154014818, 154098699,
	154182588, 154266499, 154350375, 154434256, 154518152,
	154602033, 154685891, 154769793, 154853692, 154937557,
	155021469, 155105342, 155189244, 155273112, 155356990,
	155440894, 155524783, 155608666, 155692545, 155776426,
	155860314, 155944190, 156028094, 156111991, 156195864,
	156279752, 156363649, 156447537, 156531418, 156615292,
	156699188, 156783051, 156866965, 156950831, 157034740,
	157118616, 157202512, 157286362, 157370274, 157454170,
	157538049, 157621940, 157705826, 157789710, 157873583,
	157957477, 158041322, 158125233, 158209096, 158293000,
	158376912, 158460719, 158544669, 158628558, 158712446,
	158796348, 158880206, 158964097, 159047991, 159131851,
	159215770, 159299664, 159383548, 159467434, 159551294,
	159635198, 159719079, 159802960, 159886849, 159970730,
	160054608, 160138512, 160222411, 160306292, 160390127,
	160474069, 160557948, 160641813, 160725712, 160809578,
	160893466, 160977378, 161061251, 161145148, 161229041,
	161312925, 161396788, 161480669, 161564535, 161648395,
	161732360, 161816234, 161900120, 161984011, 162067905,
	162151773, 162235677, 162319563, 162403447, 162487310,
	162571178, 162655043, 162738986, 162822818, 162906686,
	162990641, 163074492, 163158421, 163242300, 163326135,
	163410064, 163493943, 163577831, 163661722, 163745616,
	163829512, 163913378, 163997262, 164081163, 164165054,
	164248920, 164332821, 164416682, 164500586, 164584487,
	164668368, 164752244, 164836130, 164920014, 165003918,
	165087796, 165171669, 165255553, 165339441, 165423307,
	165507196, 165591105, 165674970, 165758885, 165842748,
	165926654, 166010510, 166094429, 166178320, 166262186,
	166346074, 166429960, 166513857, 166597738, 166681637,
	166765525, 166849381, 166933287, 167017181, 167100954,
	167184922, 167268839, 167352728, 167436611, 167520497,
	167604366, 167688270, 167772143, 167855991, 167939928,
	168023816, 168107687, 168191517, 168275426, 168359348,
	168443237, 168527115, 168611019, 168694895, 168778768,
	168862657, 168946530, 169030447, 169114312, 169198216,
	169282074, 169365927, 169449877, 169533756, 169617639,
	169701528, 169785409, 169869295, 169953191, 170037044,
	170120968, 170204811, 170288707, 170372622, 170456495,
	170540399, 170624264, 170708143, 170792055, 170875920,
	170959781, 171043690, 171127594, 171211477, 171295363,
	171379260, 171463143, 171547009, 171630897, 171714801,
	171798641, 171882568, 171966449, 172050338, 172134234,
	172218110, 172301989, 172385880, 172469768, 172553603,
	172637546, 172721432, 172805300, 172889189, 172973093,
	173056963, 173140855, 173224751, 173308637, 173392520,
	173476401, 173560264, 173644138, 173727965, 173811900,
	173895834, 173979726, 174063607, 174147485, 174231358,
	174315272, 174399159, 174483032, 174566915, 174650817,
	174734682, 174818574, 174902475, 174986359, 175070224,
	175154090, 175238017, 175321898, 175405776, 175489660,
	175573533, 175657411, 175741315, 175825191, 175909070,
	175992961, 176076878, 176160766, 176244558, 176328523,
	176412386, 176496308, 176580189, 176664039, 176747941,
	176831783, 176915733, 176999624, 177083505, 177167399,
	177251265, 177335171, 177418981, 177502938, 177586730,
	177670703, 177754584, 177838488, 177922369, 178006255,
	178090123, 178174027, 178257859, 178341789, 178425639,
	178509556, 178593445, 178677328, 178761194, 178845118,
	178929002, 179012872, 179096776, 179180581, 179264510,
	179348437, 179432308, 179516092, 179600085, 179683976,
	179767842, 179851754, 179935640, 180019521, 180103397,
	180187285, 180271166, 180355032, 180438941, 180522832,
	180606721, 180690563, 180774498, 180858371, 180942257,
	181026133, 181110045, 181193885, 181277812, 181361703,
	181445589, 181529473, 181613361, 181697242, 181781085,
	181864989, 181948867, 182032756, 182116660, 182200487,
	182284445, 182368334, 182452207}

// cacheSizes is a lookup table for the ethash verification cache size for the
// first 2048 epochs (i.e. 61440000 blocks).
var cacheSizes = []uint64{
	16776896, 16907456, 17039296, 17170112, 17301056, 17432512, 17563072,
	17693888, 17824192, 17955904, 18087488, 18218176, 18349504, 18481088,
	18611392, 18742336, 18874304, 19004224, 19135936, 19267264, 19398208,
	19529408, 19660096, 19791424, 19922752, 20053952, 20184896, 20315968,
	20446912, 20576576, 20709184, 20840384, 20971072, 21102272, 21233216,
	21364544, 21494848, 21626816, 21757376, 21887552, 22019392, 22151104,
	22281536, 22412224, 22543936, 22675264, 22806464, 22935872, 23068096,
	23198272, 23330752, 23459008, 23592512, 23723968, 23854912, 23986112,
	24116672, 24247616, 24378688, 24509504, 24640832, 24772544, 24903488,
	25034432, 25165376, 25296704, 25427392, 25558592, 25690048, 25820096,
	25951936, 26081728, 26214208, 26345024, 26476096, 26606656, 26737472,
	26869184, 26998208, 27131584, 27262528, 27393728, 27523904, 27655744,
	27786688, 27917888, 28049344, 28179904, 28311488, 28441792, 28573504,
	28700864, 28835648, 28966208, 29096768, 29228608, 29359808, 29490752,
	29621824, 29752256, 29882816, 30014912, 30144448, 30273728, 30406976,
	30538432, 30670784, 30799936, 30932672, 31063744, 31195072, 31325248,
	31456192, 31588288, 31719232, 31850432, 31981504, 32110784, 32243392,
	32372672, 32505664, 32636608, 32767808, 32897344, 33029824, 33160768,
	33289664, 33423296, 33554368, 33683648, 33816512, 33947456, 34076992,
	34208704, 34340032, 34471744, 34600256, 34734016, 34864576, 34993984,
	35127104, 35258176, 35386688, 35518528, 35650624, 35782336, 35910976,
	36044608, 36175808, 36305728, 36436672, 36568384, 36699968, 36830656,
	36961984, 37093312, 37223488, 37355072, 37486528, 37617472, 37747904,
	37879232, 38009792, 38141888, 38272448, 38403392, 38535104, 38660672,
	38795584, 38925632, 39059264, 39190336, 39320768, 39452096, 39581632,
	39713984, 39844928, 39974848, 40107968, 40238144, 40367168, 40500032,
	40631744, 40762816, 40894144, 41023552, 41155904, 41286208, 41418304,
	41547712, 41680448, 41811904, 41942848, 42073792, 42204992, 42334912,
	42467008, 42597824, 42729152, 42860096, 42991552, 43122368, 43253696,
	43382848, 43515712, 43646912, 43777088, 43907648, 44039104, 44170432,
	44302144, 44433344, 44564288, 44694976, 44825152, 44956864, 45088448,
	45219008, 45350464, 45481024, 45612608, 45744064, 45874496, 46006208,
	46136768, 46267712, 46399424, 46529344, 46660672, 46791488, 46923328,
	47053504, 47185856, 47316928, 47447872, 47579072, 47710144, 47839936,
	47971648, 48103232, 48234176, 48365248, 48496192, 48627136, 48757312,
	48889664, 49020736, 49149248, 49283008, 49413824, 49545152, 49675712,
	49807168, 49938368, 50069056, 50200256, 50331584, 50462656, 50593472,
	50724032, 50853952, 50986048, 51117632, 51248576, 51379904, 51510848,
	51641792, 51773248, 51903296, 52035136, 52164032, 52297664, 52427968,
	52557376, 52690112, 52821952, 52952896, 53081536, 53213504, 53344576,
	53475776, 53608384, 53738816, 53870528, 54000832, 54131776, 54263744,
	54394688, 54525248, 54655936, 54787904, 54918592, 55049152, 55181248,
	55312064, 55442752, 55574336, 55705024, 55836224, 55967168, 56097856,
	56228672, 56358592, 56490176, 56621888, 56753728, 56884928, 57015488,
	57146816, 57278272, 57409216, 57540416, 57671104, 57802432, 57933632,
	58064576, 58195264, 58326976, 58457408, 58588864, 58720192, 58849984,
	58981696, 59113024, 59243456, 59375552, 59506624, 59637568, 59768512,
	59897792, 60030016, 60161984, 60293056, 60423872, 60554432, 60683968,
	60817216, 60948032, 61079488, 61209664, 61341376, 61471936, 61602752,
	61733696, 61865792, 61996736, 62127808, 62259136, 62389568, 62520512,
	62651584, 62781632, 62910784, 63045056, 63176128, 63307072, 63438656,
	63569216, 63700928, 63831616, 63960896, 64093888, 64225088, 64355392,
	64486976, 64617664, 64748608, 64879424, 65009216, 65142464, 65273792,
	65402816, 65535424, 65666752, 65797696, 65927744, 66060224, 66191296,
	66321344, 66453056, 66584384, 66715328, 66846656, 66977728, 67108672,
	67239104, 67370432, 67501888, 67631296, 67763776, 67895104, 68026304,
	68157248, 68287936, 68419264, 68548288, 68681408, 68811968, 68942912,
	69074624, 69205568, 69337024, 69467584, 69599168, 69729472, 69861184,
	69989824, 70122944, 70253888, 70385344, 70515904, 70647232, 70778816,
	70907968, 71040832, 71171648, 71303104, 71432512, 71564992, 71695168,
	71826368, 71958464, 72089536, 72219712, 72350144, 72482624, 72613568,
	72744512, 72875584, 73006144, 73138112, 73268672, 73400128, 73530944,
	73662272, 73793344, 73924544, 74055104, 74185792, 74316992, 74448832,
	74579392, 74710976, 74841664, 74972864, 75102784, 75233344, 75364544,
	75497024, 75627584, 75759296, 75890624, 76021696, 76152256, 76283072,
	76414144, 76545856, 76676672, 76806976, 76937792, 77070016, 77200832,
	77331392, 77462464, 77593664, 77725376, 77856448, 77987776, 78118336,
	78249664, 78380992, 78511424, 78642496, 78773056, 78905152, 79033664,
	79166656, 79297472, 79429568, 79560512, 79690816, 79822784, 79953472,
	80084672, 80214208, 80346944, 80477632, 80608576, 80740288, 80870848,
	81002048, 81133504, 81264448, 81395648, 81525952, 81657536, 81786304,
	81919808, 82050112, 82181312, 82311616, 82443968, 82573376, 82705984,
	82835776, 82967744, 83096768, 83230528, 83359552, 83491264, 83622464,
	83753536, 83886016, 84015296, 84147776, 84277184, 84409792, 84540608,
	84672064, 84803008, 84934336, 85065152, 85193792, 85326784, 85458496,
	85589312, 85721024, 85851968, 85982656, 86112448, 86244416, 86370112,
	86506688, 86637632, 86769344, 86900672, 87031744, 87162304, 87293632,
	87424576, 87555392, 87687104, 87816896, 87947968, 88079168, 88211264,
	88341824, 88473152, 88603712, 88735424, 88862912, 88996672, 89128384,
	89259712, 89390272, 89521984, 89652544, 89783872, 89914816, 90045376,
	90177088, 90307904, 90438848, 90569152, 90700096, 90832832, 90963776,
	91093696, 91223744, 91356992, 91486784, 91618496, 91749824, 91880384,
	92012224, 92143552, 92273344, 92405696, 92536768, 92666432, 92798912,
	92926016, 93060544, 93192128, 93322816, 93453632, 93583936, 93715136,
	93845056, 93977792, 94109504, 94240448, 94371776, 94501184, 94632896,
	94764224, 94895552, 95023424, 95158208, 95287744, 95420224, 95550016,
	95681216, 95811904, 95943872, 96075328, 96203584, 96337856, 96468544,
	96599744, 96731072, 96860992, 96992576, 97124288, 97254848, 97385536,
	97517248, 97647808, 97779392, 97910464, 98041408, 98172608, 98303168,
	98434496, 98565568, 98696768, 98827328, 98958784, 99089728, 99220928,
	99352384, 99482816, 99614272, 99745472, 99876416, 100007104,
	100138048, 100267072, 100401088, 100529984, 100662592, 100791872,
	100925248, 101056064, 101187392, 101317952, 101449408, 101580608,
	101711296, 101841728, 101973824, 102104896, 102235712, 102366016,
	102498112, 102628672, 102760384, 102890432, 103021888, 103153472,
	103284032, 103415744, 103545152, 103677248, 103808576, 103939648,
	104070976, 104201792, 104332736, 104462528, 104594752, 104725952,
	104854592, 104988608, 105118912, 105247808, 105381184, 105511232,
	105643072, 105774784, 105903296, 106037056, 106167872, 106298944,
	106429504, 106561472, 106691392, 106822592, 106954304, 107085376,
	107216576, 107346368, 107478464, 107609792, 107739712, 107872192,
	108003136, 108131392, 108265408, 108396224, 108527168, 108657344,
	108789568, 108920384, 109049792, 109182272, 109312576, 109444928,
	109572928, 109706944, 109837888, 109969088, 110099648, 110230976,
	110362432, 110492992, 110624704, 110755264, 110886208, 111017408,
	111148864, 111279296, 111410752, 111541952, 111673024, 111803456,
	111933632, 112066496, 112196416, 112328512, 112457792, 112590784,
	112715968, 112852672, 112983616, 113114944, 113244224, 113376448,
	113505472, 113639104, 113770304, 113901376, 114031552, 114163264,
	114294592, 114425536, 114556864, 114687424, 114818624, 114948544,
	115080512, 115212224, 115343296, 115473472, 115605184, 115736128,
	115867072, 115997248, 116128576, 116260288, 116391488, 116522944,
	116652992, 116784704, 116915648, 117046208, 117178304, 117308608,
	117440192, 117569728, 117701824, 117833024, 117964096, 118094656,
	118225984, 118357312, 118489024, 118617536, 118749632, 118882112,
	119012416, 119144384, 119275328, 119406016, 119537344, 119668672,
	119798464, 119928896, 120061376, 120192832, 120321728, 120454336,
	120584512, 120716608, 120848192, 120979136, 121109056, 121241408,
	121372352, 121502912, 121634752, 121764416, 121895744, 122027072,
	122157632, 122289088, 122421184, 122550592, 122682944, 122813888,
	122945344, 123075776, 123207488, 123338048, 123468736, 123600704,
	123731264, 123861952, 123993664, 124124608, 124256192, 124386368,
	124518208, 124649024, 124778048, 124911296, 125041088, 125173696,
	125303744, 125432896, 125566912, 125696576, 125829056, 125958592,
	126090304, 126221248, 126352832, 126483776, 126615232, 126746432,
	126876608, 127008704, 127139392, 127270336, 127401152, 127532224,
	127663552, 127794752, 127925696, 128055232, 128188096, 128319424,
	128449856, 128581312, 128712256, 128843584, 128973632, 129103808,
	129236288, 129365696, 129498944, 129629888, 129760832, 129892288,
	130023104, 130154048, 130283968, 130416448, 130547008, 130678336,
	130807616, 130939456, 131071552, 131202112, 131331776, 131464384,
	131594048, 131727296, 131858368, 131987392, 132120256, 132250816,
	132382528, 132513728, 132644672, 132774976, 132905792, 133038016,
	133168832, 133299392, 133429312, 133562048, 133692992, 133823296,
	133954624, 134086336, 134217152, 134348608, 134479808, 134607296,
	134741056, 134872384, 135002944, 135134144, 135265472, 135396544,
	135527872, 135659072, 135787712, 135921472, 136052416, 136182848,
	136313792, 136444864, 136576448, 136707904, 136837952, 136970048,
	137099584, 137232064, 137363392, 137494208, 137625536, 137755712,
	137887424, 138018368, 138149824, 138280256, 138411584, 138539584,
	138672832, 138804928, 138936128, 139066688, 139196864, 139328704,
	139460032, 139590208, 139721024, 139852864, 139984576, 140115776,
	140245696, 140376512, 140508352, 140640064, 140769856, 140902336,
	141032768, 141162688, 141294016, 141426496, 141556544, 141687488,
	141819584, 141949888, 142080448, 142212544, 142342336, 142474432,
	142606144, 142736192, 142868288, 142997824, 143129408, 143258944,
	143392448, 143523136, 143653696, 143785024, 143916992, 144045632,
	144177856, 144309184, 144440768, 144570688, 144701888, 144832448,
	144965056, 145096384, 145227584, 145358656, 145489856, 145620928,
	145751488, 145883072, 146011456, 146144704, 146275264, 146407232,
	146538176, 146668736, 146800448, 146931392, 147062336, 147193664,
	147324224, 147455936, 147586624, 147717056, 147848768, 147979456,
	148110784, 148242368, 148373312, 148503232, 148635584, 148766144,
	148897088, 149028416, 149159488, 149290688, 149420224, 149551552,
	149683136, 149814976, 149943616, 150076352, 150208064, 150338624,
	150470464, 150600256, 150732224, 150862784, 150993088, 151125952,
	151254976, 151388096, 151519168, 151649728, 151778752, 151911104,
	152042944, 152174144, 152304704, 152435648, 152567488, 152698816,
	152828992, 152960576, 153091648, 153222976, 153353792, 153484096,
	153616192, 153747008, 153878336, 154008256, 154139968, 154270912,
	154402624, 154533824, 154663616, 154795712, 154926272, 155057984,
	155188928, 155319872, 155450816, 155580608, 155712064, 155843392,
	155971136, 156106688, 156237376, 156367424, 156499264, 156630976,
	156761536, 156892352, 157024064, 157155008, 157284416, 157415872,
	157545536, 157677248, 157810496, 157938112, 158071744, 158203328,
	158334656, 158464832, 158596288, 158727616, 158858048, 158988992,
	159121216, 159252416, 159381568, 159513152, 159645632, 159776192,
	159906496, 160038464, 160169536, 160300352, 160430656, 160563008,
	160693952, 160822208, 160956352, 161086784, 161217344, 161349184,
	161480512, 161611456, 161742272, 161873216, 162002752, 162135872,
	162266432, 162397888, 162529216, 162660032, 162790976, 162922048,
	163052096, 163184576, 163314752, 163446592, 163577408, 163707968,
	163839296, 163969984, 164100928, 164233024, 164364224, 164494912,
	164625856, 164756672, 164887616, 165019072, 165150016, 165280064,
	165412672, 165543104, 165674944, 165805888, 165936832, 166067648,
	166198336, 166330048, 166461248, 166591552, 166722496, 166854208,
	166985408, 167116736, 167246656, 167378368, 167508416, 167641024,
	167771584, 167903168, 168034112, 168164032, 168295744, 168427456,
	168557632, 168688448, 168819136, 168951616, 169082176, 169213504,
	169344832, 169475648, 169605952, 169738048, 169866304, 169999552,
	170131264, 170262464, 170393536, 170524352, 170655424, 170782016,
	170917696, 171048896, 171179072, 171310784, 171439936, 171573184,
	171702976, 171835072, 171966272, 172097216, 172228288, 172359232,
	172489664, 172621376, 172747712, 172883264, 173014208, 173144512,
	173275072, 173407424, 173539136, 173669696, 173800768, 173931712,
	174063424, 174193472, 174325696, 174455744, 174586816, 174718912,
	174849728, 174977728, 175109696, 175242688, 175374272, 175504832,
	175636288, 175765696, 175898432, 176028992, 176159936, 176291264,
	176422592, 176552512, 176684864, 176815424, 176946496, 177076544,
	177209152, 177340096, 177470528, 177600704, 177731648, 177864256,
	177994816, 178126528, 178257472, 178387648, 178518464, 178650176,
	178781888, 178912064, 179044288, 179174848, 179305024, 179436736,
	179568448, 179698496, 179830208, 179960512, 180092608, 180223808,
	180354752, 180485696, 180617152, 180748096, 180877504, 181009984,
	181139264, 181272512, 181402688, 181532608, 181663168, 181795136,
	181926592, 182057536, 182190016, 182320192, 182451904, 182582336,
	182713792, 182843072, 182976064, 183107264, 183237056, 183368384,
	183494848, 183631424, 183762752, 183893824, 184024768, 184154816,
	184286656, 184417984, 184548928, 184680128, 184810816, 184941248,
	185072704, 185203904, 185335616, 185465408, 185596352, 185727296,
	185859904, 185989696, 186121664, 186252992, 186383552, 186514112,
	186645952, 186777152, 186907328, 187037504, 187170112, 187301824,
	187429184, 187562048, 187693504, 187825472, 187957184, 188087104,
	188218304, 188349376, 188481344, 188609728, 188743616, 188874304,
	189005248, 189136448, 189265088, 189396544, 189528128, 189660992,
	189791936, 189923264, 190054208, 190182848, 190315072, 190447424,
	190577984, 190709312, 190840768, 190971328, 191102656, 191233472,
	191364032, 191495872, 191626816, 191758016, 191888192, 192020288,
	192148928, 192282176, 192413504, 192542528, 192674752, 192805952,
	192937792, 193068608, 193198912, 193330496, 193462208, 193592384,
	193723456, 193854272, 193985984, 194116672, 194247232, 194379712,
	194508352, 194641856, 194772544, 194900672, 195035072, 195166016,
	195296704, 195428032, 195558592, 195690304, 195818176, 195952576,
	196083392, 196214336, 196345792, 196476736, 196607552, 196739008,
	196869952, 197000768, 197130688, 197262784, 197394368, 197523904,
	197656384, 197787584, 197916608, 198049472, 198180544, 198310208,
	198442432, 198573632, 198705088, 198834368, 198967232, 199097792,
	199228352, 199360192, 199491392, 199621696, 199751744, 199883968,
	200014016, 200146624, 200276672, 200408128, 200540096, 200671168,
	200801984, 200933312, 201062464, 201194944, 201326144, 201457472,
	201588544, 201719744, 201850816, 201981632, 202111552, 202244032,
	202374464, 202505152, 202636352, 202767808, 202898368, 203030336,
	203159872, 203292608, 203423296, 203553472, 203685824, 203816896,
	203947712, 204078272, 204208192, 204341056, 204472256, 204603328,
	204733888, 204864448, 204996544, 205125568, 205258304, 205388864,
	205517632, 205650112, 205782208, 205913536, 206044736, 206176192,
	206307008, 206434496, 206569024, 206700224, 206831168, 206961856,
	207093056, 207223616, 207355328, 207486784, 207616832, 207749056,
	207879104, 208010048, 208141888, 208273216, 208404032, 208534336,
	208666048, 208796864, 208927424, 209059264, 209189824, 209321792,
	209451584, 209582656, 209715136, 209845568, 209976896, 210106432,
	210239296, 210370112, 210501568, 210630976, 210763712, 210894272,
	211024832, 211156672, 211287616, 211418176, 211549376, 211679296,
	211812032, 211942592, 212074432, 212204864, 212334016, 212467648,
	212597824, 212727616, 212860352, 212991424, 213120832, 213253952,
	213385024, 213515584, 213645632, 213777728, 213909184, 214040128,
	214170688, 214302656, 214433728, 214564544, 214695232, 214826048,
	214956992, 215089088, 215219776, 215350592, 215482304, 215613248,
	215743552, 215874752, 216005312, 216137024, 216267328, 216399296,
	216530752, 216661696, 216790592, 216923968, 217054528, 217183168,
	217316672, 217448128, 217579072, 217709504, 217838912, 217972672,
	218102848, 218233024, 218364736, 218496832, 218627776, 218759104,
	218888896, 219021248, 219151936, 219281728, 219413056, 219545024,
	219675968, 219807296, 219938624, 220069312, 220200128, 220331456,
	220461632, 220592704, 220725184, 220855744, 220987072, 221117888,
	221249216, 221378368, 221510336, 221642048, 221772736, 221904832,
	222031808, 222166976, 222297536, 222428992, 222559936, 222690368,
	222820672, 222953152, 223083968, 223213376, 223345984, 223476928,
	223608512, 223738688, 223869376, 224001472, 224132672, 224262848,
	224394944, 224524864, 224657344, 224788288, 224919488, 225050432,
	225181504, 225312704, 225443776, 225574592, 225704768, 225834176,
	225966784, 226097216, 226229824, 226360384, 226491712, 226623424,
	226754368, 226885312, 227015104, 227147456, 227278528, 227409472,
	227539904, 227669696, 227802944, 227932352, 228065216, 228196288,
	228326464, 228457792, 228588736, 228720064, 228850112, 228981056,
	229113152, 229243328, 229375936, 229505344, 229636928, 229769152,
	229894976, 230030272, 230162368, 230292416, 230424512, 230553152,
	230684864, 230816704, 230948416, 231079616, 231210944, 231342016,
	231472448, 231603776, 231733952, 231866176, 231996736, 232127296,
	232259392, 232388672, 232521664, 232652608, 232782272, 232914496,
	233043904, 233175616, 233306816, 233438528, 233569984, 233699776,
	233830592, 233962688, 234092224, 234221888, 234353984, 234485312,
	234618304, 234749888, 234880832, 235011776, 235142464, 235274048,
	235403456, 235535936, 235667392, 235797568, 235928768, 236057152,
	236190272, 236322752, 236453312, 236583616, 236715712, 236846528,
	236976448, 237108544, 237239104, 237371072, 237501632, 237630784,
	237764416, 237895232, 238026688, 238157632, 238286912, 238419392,
	238548032, 238681024, 238812608, 238941632, 239075008, 239206336,
	239335232, 239466944, 239599168, 239730496, 239861312, 239992384,
	240122816, 240254656, 240385856, 240516928, 240647872, 240779072,
	240909632, 241040704, 241171904, 241302848, 241433408, 241565248,
	241696192, 241825984, 241958848, 242088256, 242220224, 242352064,
	242481856, 242611648, 242744896, 242876224, 243005632, 243138496,
	243268672, 243400384, 243531712, 243662656, 243793856, 243924544,
	244054592, 244187072, 244316608, 244448704, 244580032, 244710976,
	244841536, 244972864, 245104448, 245233984, 245365312, 245497792,
	245628736, 245759936, 245889856, 246021056, 246152512, 246284224,
	246415168, 246545344, 246675904, 246808384, 246939584, 247070144,
	247199552, 247331648, 247463872, 247593536, 247726016, 247857088,
	247987648, 248116928, 248249536, 248380736, 248512064, 248643008,
	248773312, 248901056, 249036608, 249167552, 249298624, 249429184,
	249560512, 249692096, 249822784, 249954112, 250085312, 250215488,
	250345792, 250478528, 250608704, 250739264, 250870976, 251002816,
	251133632, 251263552, 251395136, 251523904, 251657792, 251789248,
	251919424, 252051392, 252182464, 252313408, 252444224, 252575552,
	252706624, 252836032, 252968512, 253099712, 253227584, 253361728,
	253493056, 253623488, 253754432, 253885504, 254017216, 254148032,
	254279488, 254410432, 254541376, 254672576, 254803264, 254933824,
	255065792, 255196736, 255326528, 255458752, 255589952, 255721408,
	255851072, 255983296, 256114624, 256244416, 256374208, 256507712,
	256636096, 256768832, 256900544, 257031616, 257162176, 257294272,
	257424448, 257555776, 257686976, 257818432, 257949632, 258079552,
	258211136, 258342464, 258473408, 258603712, 258734656, 258867008,
	258996544, 259127744, 259260224, 259391296, 259522112, 259651904,
	259784384, 259915328, 260045888, 260175424, 260308544, 260438336,
	260570944, 260700992, 260832448, 260963776, 261092672, 261226304,
	261356864, 261487936, 261619648, 261750592, 261879872, 262011968,
	262143424, 262274752, 262404416, 262537024, 262667968, 262799296,
	262928704, 263061184, 263191744, 263322944, 263454656, 263585216,
	263716672, 263847872, 263978944, 264108608, 264241088, 264371648,
	264501184, 264632768, 264764096, 264895936, 265024576, 265158464,
	265287488, 265418432, 265550528, 265681216, 265813312, 265943488,
	266075968, 266206144, 266337728, 266468032, 266600384, 266731072,
	266862272, 266993344, 267124288, 267255616, 267386432, 267516992,
	267648704, 267777728, 267910592, 268040512, 268172096, 268302784,
	268435264, 268566208, 268696256, 268828096, 268959296, 269090368,
	269221312, 269352256, 269482688, 269614784, 269745856, 269876416,
	270007616, 270139328, 270270272, 270401216, 270531904, 270663616,
	270791744, 270924736, 271056832, 271186112, 271317184, 271449536,
	271580992, 271711936, 271843136, 271973056, 272105408, 272236352,
	272367296, 272498368, 272629568, 272759488, 272891456, 273022784,
	273153856, 273284672, 273415616, 273547072, 273677632, 273808448,
	273937088, 274071488, 274200896, 274332992, 274463296, 274595392,
	274726208, 274857536, 274988992, 275118656, 275250496, 275382208,
	275513024, 275643968, 275775296, 275906368, 276037184, 276167872,
	276297664, 276429376, 276560576, 276692672, 276822976, 276955072,
	277085632, 277216832, 277347008, 277478848, 277609664, 277740992,
	277868608, 278002624, 278134336, 278265536, 278395328, 278526784,
	278657728, 278789824, 278921152, 279052096, 279182912, 279313088,
	279443776, 279576256, 279706048, 279838528, 279969728, 280099648,
	280230976, 280361408, 280493632, 280622528, 280755392, 280887104,
	281018176, 281147968, 281278912, 281411392, 281542592, 281673152,
	281803712, 281935552, 282066496, 282197312, 282329024, 282458816,
	282590272, 282720832, 282853184, 282983744, 283115072, 283246144,
	283377344, 283508416, 283639744, 283770304, 283901504, 284032576,
	284163136, 284294848, 284426176, 284556992, 284687296, 284819264,
	284950208, 285081536}
